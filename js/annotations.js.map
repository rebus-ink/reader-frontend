{"version":3,"file":"annotations.js","sources":["../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/event.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/weakset.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/assign.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poly/contains.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poly/matches.js","../node_modules/wicked-elements/esm/3rd/regular-elements/index.js","../node_modules/wicked-elements/esm/3rd/regular-elements/3rd/disconnected.js","../node_modules/wicked-elements/esm/3rd/regular-elements/3rd/attributechanged.js","../node_modules/wicked-elements/esm/index.js","../node_modules/ancestors/index.js","../node_modules/index-of/index.js","../node_modules/dom-seek/lib/index.js","../node_modules/dom-seek/index.js","../components/annotations/highlight.js","../components/annotations/save-note-event.js","../components/annotations/marker.js","../components/annotations/sidebar.js","../node_modules/@ungap/weakmap/esm/index.js","../node_modules/@ungap/template-literal/esm/index.js","../node_modules/@ungap/template-tag-arguments/esm/index.js","../node_modules/hyperhtml-wire/esm/index.js","../node_modules/lighterhtml/esm/shared.js","../node_modules/@ungap/create-content/esm/index.js","../node_modules/@ungap/essential-map/esm/index.js","../node_modules/lighterhtml/node_modules/domdiff/esm/utils.js","../node_modules/lighterhtml/node_modules/domdiff/esm/index.js","../node_modules/@ungap/import-node/esm/index.js","../node_modules/domtagger/esm/constants.js","../node_modules/@ungap/trim/esm/index.js","../node_modules/domtagger/esm/sanitizer.js","../node_modules/domtagger/esm/walker.js","../node_modules/domtagger/esm/index.js","../node_modules/hyperhtml-style/esm/index.js","../node_modules/lighterhtml/esm/tagger.js","../node_modules/lighterhtml/esm/index.js","../components/annotations/marker-menu.js","../components/annotations/xpaths.js","../components/annotations/notes.js"],"sourcesContent":["/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nvar $Event;\n\ntry {\n  new Event('!');\n  $Event = Event;\n} catch(o_O) {\n  try {\n    new CustomEvent('!');\n    $Event = CustomEvent;\n  } catch(o_O) {\n    $Event = function (type) {\n      var e = document.createEvent('Event');\n      e.initEvent(type, false, false);\n      return e;\n    };\n  }\n}\n\nexport default $Event;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nvar $WeakSet;\n\ntry {\n  $WeakSet = (new WeakSet).constructor;\n} catch(o_O) {\n  try {\n    // IE11 apparently has WeakMap but no WeakSet\n    o_O = ($WeakSet = new WeakMap && function () {\n      this.$ = new WeakMap;\n    }).prototype;\n    o_O.add = function (O) {\n      this.$.set(O, 0);\n      return this;\n    };\n    o_O.has = function (O) {\n      return this.$.has(O);\n    };\n    o_O.delete = function (O) {\n      return this.$.delete(O);\n    };\n  } catch(o_O) {\n    // all other browsers\n    var i = 0;\n    o_O = ($WeakSet = function () {\n      this.$ = ['__', Math.random(), i++, '__'].join('ws');\n    }).prototype;\n    o_O.add = function (O) {\n      if (!this.has(O))\n        Object.defineProperty(O, this.$, {value:true, configurable:true});\n      return this;\n    };\n    o_O.has = function (O) {\n      return this.hasOwnProperty.call(O, this.$);\n    };\n    o_O.delete = function (O) {\n      return delete O[this.$];\n    };\n  }\n}\n\nexport default $WeakSet;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nexport default Object.assign || function (target) {\n  for (var o, i = 1; i < arguments.length; i++) {\n    o = arguments[i] || {};\n    for (var k in o) {\n      if (o.hasOwnProperty(k))\n        target[k] = o[k];\n    }\n  }\n  return target;\n};\n","// borrowed from https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L361\nvar contains = document.contains || function (el) {\n  while (el && el !== this) el = el.parentNode;\n  return this === el;\n};\n\nexport default contains;\n","var indexOf = [].indexOf;\n\n// borrowed from https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L130\nvar matches = 'matches' in document.documentElement ?\n  function (el, selector) {\n    return el.matches(selector);\n  } :\n  function (el, selector) {\n    return (\n      el.matchesSelector ||\n      el.webkitMatchesSelector ||\n      el.khtmlMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector ||\n      fallback\n    ).call(el, selector);\n  };\n\nexport default matches;\n\nfunction fallback(selector) {\n  var parentNode = this.parentNode;\n  return !!parentNode && -1 < indexOf.call(\n    parentNode.querySelectorAll(selector),\n    this\n  );\n}\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport Event from './poorly/event.js';\nimport WeakSet from './poorly/weakset.js';\nimport assign from './poorly/assign.js';\n\nimport contains from './poly/contains.js';\nimport matches from './poly/matches.js';\n\nimport attributechanged from './3rd/attributechanged.js';\nimport disconnected from './3rd/disconnected.js';\n\nvar bootstrap = true;\n\nvar query = [];\nvar config = [];\nvar waiting = {};\nvar known = {};\n\nvar regularElements = {\n  Event: Event,\n  WeakSet: WeakSet,\n  assign: assign,\n  document: document,\n  define: function (selector, options) {\n    if (bootstrap) {\n      bootstrap = false;\n      init(regularElements.document);\n    }\n    var type = typeof selector;\n    if (type === 'string') {\n      if (-1 < query.indexOf(selector))\n        throw new Error('duplicated: ' + selector);\n      query.push(selector);\n      config.push(options || {});\n      ready();\n      if (selector in waiting) {\n        waiting[selector](config[config.length - 1]);\n        delete waiting[selector];\n      }\n    } else {\n      if (type !== \"object\" || selector.nodeType !== 1)\n        throw new Error('undefinable: ' + selector);\n      setupListeners(selector, options || {});\n    }\n  },\n  get: function (selector) {\n    var i = query.indexOf(selector);\n    return i < 0 ? null : assign({}, config[i]);\n  },\n  whenDefined: function (selector) {\n    return Promise.resolve(\n      regularElements.get(selector) ||\n      new Promise(function ($) {\n        waiting[selector] = $;\n      })\n    );\n  }\n};\n\n// passing along regularElements as poly for Event and WeakSet\nvar lifecycle = disconnected(regularElements);\nvar observe = {\n  attributechanged: attributechanged(regularElements),\n  connected: lifecycle,\n  disconnected: lifecycle\n};\n\nexport default regularElements;\nexport {regularElements, assign, Event, WeakSet};\n\nfunction changes(records) {\n  for (var i = 0, length = records.length; i < length; i++)\n    setupList(records[i].addedNodes, false);\n}\n\nfunction init(doc) {\n  try {\n    (new MutationObserver(changes))\n      .observe(doc, {subtree: true, childList: true});\n  }\n  catch(o_O) {\n    doc.addEventListener(\n      'DOMNodeInserted',\n      function (e) {\n        changes([{addedNodes: [e.target]}]);\n      },\n      false\n    );\n  }\n  if (doc.readyState !== 'complete')\n    doc.addEventListener('DOMContentLoaded', ready, {once: true});\n}\n\nfunction ready() {\n  if (query.length)\n    setupList(regularElements.document.querySelectorAll(query), true);\n}\n\nfunction setup(node) {\n  setupList(node.querySelectorAll(query), true);\n  for (var ws, css, i = 0, length = query.length; i < length; i++) {\n    css = query[i];\n    ws = known[css] || (known[css] = new WeakSet);\n    if (!ws.has(node) && matches(node, query[i])) {\n      ws.add(node);\n      setupListeners(node, config[i]);\n    }\n  }\n}\n\nfunction setupList(nodes, isElement) {\n  for (var node, i = 0, length = nodes.length; i < length; i++) {\n    node = nodes[i];\n    if (isElement || node.nodeType === 1)\n      setup(node);\n  }\n}\n\nfunction setupListener(node, options, type, dispatch) {\n  var method = options['on' + type];\n  if (method) {\n    observe[type](node, options.attributeFilter)\n      .addEventListener(type, method, false);\n    if (dispatch && contains.call(regularElements.document, node))\n      node.dispatchEvent(new Event(type));\n  }\n}\n\nfunction setupListeners(node, options) {\n  setupListener(node, options, 'attributechanged', false);\n  setupListener(node, options, 'disconnected', false);\n  setupListener(node, options, 'connected', true);\n}\n","/*! (c) Andrea Giammarchi */\nfunction disconnected(poly) {'use strict';\n  var CONNECTED = 'connected';\n  var DISCONNECTED = 'dis' + CONNECTED;\n  var Event = poly.Event;\n  var WeakSet = poly.WeakSet;\n  var notObserving = true;\n  var observer = new WeakSet;\n  return function observe(node) {\n    if (notObserving) {\n      notObserving = !notObserving;\n      startObserving(node.ownerDocument);\n    }\n    observer.add(node);\n    return node;\n  };\n  function startObserving(document) {\n    var dispatched = null;\n    try {\n      (new MutationObserver(changes)).observe(\n        document,\n        {subtree: true, childList: true}\n      );\n    }\n    catch(o_O) {\n      var timer = 0;\n      var records = [];\n      var reschedule = function (record) {\n        records.push(record);\n        clearTimeout(timer);\n        timer = setTimeout(\n          function () {\n            changes(records.splice(timer = 0, records.length));\n          },\n          0\n        );\n      };\n      document.addEventListener(\n        'DOMNodeRemoved',\n        function (event) {\n          reschedule({addedNodes: [], removedNodes: [event.target]});\n        },\n        true\n      );\n      document.addEventListener(\n        'DOMNodeInserted',\n        function (event) {\n          reschedule({addedNodes: [event.target], removedNodes: []});\n        },\n        true\n      );\n    }\n    function changes(records) {\n      dispatched = new Tracker;\n      for (var\n        record,\n        length = records.length,\n        i = 0; i < length; i++\n      ) {\n        record = records[i];\n        dispatchAll(record.removedNodes, DISCONNECTED, CONNECTED);\n        dispatchAll(record.addedNodes, CONNECTED, DISCONNECTED);\n      }\n      dispatched = null;\n    }\n    function dispatchAll(nodes, type, counter) {\n      for (var\n        node,\n        event = new Event(type),\n        length = nodes.length,\n        i = 0; i < length;\n        (node = nodes[i++]).nodeType === 1 &&\n        dispatchTarget(node, event, type, counter)\n      );\n    }\n    function dispatchTarget(node, event, type, counter) {\n      if (observer.has(node) && !dispatched[type].has(node)) {\n        dispatched[counter].delete(node);\n        dispatched[type].add(node);\n        node.dispatchEvent(event);\n        /*\n        // The event is not bubbling (perf reason: should it?),\n        // hence there's no way to know if\n        // stop/Immediate/Propagation() was called.\n        // Should DOM Level 0 work at all?\n        // I say it's a YAGNI case for the time being,\n        // and easy to implement in user-land.\n        if (!event.cancelBubble) {\n          var fn = node['on' + type];\n          if (fn)\n            fn.call(node, event);\n        }\n        */\n      }\n      for (var\n        children = node.children,\n        length = children.length,\n        i = 0; i < length;\n        dispatchTarget(children[i++], event, type, counter)\n      );\n    }\n    function Tracker() {\n      this[CONNECTED] = new WeakSet;\n      this[DISCONNECTED] = new WeakSet;\n    }\n  }\n}\nexport default disconnected;\n","/*! (c) Andrea Giammarchi */\nfunction attributechanged(poly) {'use strict';\n  var Event = poly.Event;\n  return function observe(node, attributeFilter) {\n    var options = {attributes: true, attributeOldValue: true};\n    var filtered = attributeFilter instanceof Array && attributeFilter.length;\n    if (filtered)\n      options.attributeFilter = attributeFilter.slice(0);\n    try {\n      (new MutationObserver(changes)).observe(node, options);\n    } catch(o_O) {\n      options.handleEvent = filtered ? handleEvent : attrModified;\n      node.addEventListener('DOMAttrModified', options, true);\n    }\n    return node;\n  };\n  function attrModified(event) {\n    dispatchEvent(event.target, event.attrName, event.prevValue);\n  }\n  function dispatchEvent(node, attributeName, oldValue) {\n    var event = new Event('attributechanged');\n    event.attributeName = attributeName;\n    event.oldValue = oldValue;\n    event.newValue = node.getAttribute(attributeName);\n    node.dispatchEvent(event);\n  }\n  function changes(records) {\n    for (var record, i = 0, length = records.length; i < length; i++) {\n      record = records[i];\n      dispatchEvent(record.target, record.attributeName, record.oldValue);\n    }\n  }\n  function handleEvent(event) {\n    if (-1 < this.attributeFilter.indexOf(event.attrName))\n      attrModified(event);\n  }\n}\nexport default attributechanged;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport regularElements, {WeakSet} from './3rd/regular-elements/index.js';\n\n// minifier friendly constants\nvar ATTRIBUTE_FILTER = 'attributeFilter';\nvar ONDISCONNECTED = 'ondisconnected';\nvar ONATTRIBUTECHANGED = 'onattributechanged';\n\n// one off scoped shortcut\nvar create = Object.create;\n\n// get() and whenDefined() are just the same\n// NOTE: the component is not returned,\n//       only its initial definition.\n//       This works well in terms of security\n//       so that a component prototype won't be\n//       exposed directly through the API.\nvar wickedElements = create(regularElements, {\n  define: {\n    value: function (selector, component) {\n      var ws = new WeakSet;\n      var definition = {onconnected: setup};\n      if (ONDISCONNECTED in component)\n        definition[ONDISCONNECTED] = setup;\n      if (ONATTRIBUTECHANGED in component) {\n        definition[ONATTRIBUTECHANGED] = setup;\n        definition[ATTRIBUTE_FILTER] = component[ATTRIBUTE_FILTER] || [];\n      }\n      addIfNeeded(component, 'init', init);\n      addIfNeeded(component, 'handleEvent', handleEvent);\n      regularElements.define(selector, definition);\n      function setup(event) {\n        var el = event.currentTarget;\n        var type = event.type;\n        el.removeEventListener(type, setup);\n        if (!ws.has(el)) {\n          ws.add(el);\n          bootstrap(component, event, el, 'on' + type);\n        }\n      }\n    }\n  }\n});\n\nexport default wickedElements;\n\nfunction addIfNeeded(component, key, value) {\n  if (!(key in component))\n    component[key] = value;\n}\n\nfunction bootstrap(component, event, el, method) {\n  var handler = create(component);\n  var invoke = false;\n  for (var key in component) {\n    if (key.slice(0, 2) === 'on') {\n      el.addEventListener(key.slice(2), handler, false);\n      if (key === method)\n        invoke = !invoke;\n    }\n  }\n  handler.init(event);\n  if (invoke)\n    handler.handleEvent(event);\n}\n\nfunction handleEvent(event) {\n  var type = 'on' + event.type;\n  if (type in this)\n    this[type](event);\n}\n\nfunction init(event) {\n  this.el = event.currentTarget;\n}\n","module.exports = parents\n\nfunction parents(node, filter) {\n  var out = []\n\n  filter = filter || noop\n\n  do {\n    out.push(node)\n    node = node.parentNode\n  } while(node && node.tagName && filter(node))\n\n  return out.slice(1)\n}\n\nfunction noop(n) {\n  return true\n}\n","/*!\n * index-of <https://github.com/jonschlinkert/index-of>\n *\n * Copyright (c) 2014-2015 Jon Schlinkert.\n * Licensed under the MIT license.\n */\n\n'use strict';\n\nmodule.exports = function indexOf(arr, ele, start) {\n  start = start || 0;\n  var idx = -1;\n\n  if (arr == null) return idx;\n  var len = arr.length;\n  var i = start < 0\n    ? (len + start)\n    : start;\n\n  if (i >= arr.length) {\n    return -1;\n  }\n\n  while (i < len) {\n    if (arr[i] === ele) {\n      return i;\n    }\n    i++;\n  }\n\n  return -1;\n};\n","'use strict';\n\nexports.__esModule = true;\nexports['default'] = seek;\n\nvar _ancestors = require('ancestors');\n\nvar _ancestors2 = _interopRequireDefault(_ancestors);\n\nvar _indexOf = require('index-of');\n\nvar _indexOf2 = _interopRequireDefault(_indexOf);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar E_SHOW = 'Argument 1 of seek must use filter NodeFilter.SHOW_TEXT.';\nvar E_WHERE = 'Argument 2 of seek must be a number or a Text Node.';\n\nvar SHOW_TEXT = 4;\nvar TEXT_NODE = 3;\n\nfunction seek(iter, where) {\n  if (iter.whatToShow !== SHOW_TEXT) {\n    throw new Error(E_SHOW);\n  }\n\n  var count = 0;\n  var node = iter.referenceNode;\n  var predicates = null;\n\n  if (isNumber(where)) {\n    predicates = {\n      forward: function forward() {\n        return count < where;\n      },\n      backward: function backward() {\n        return count > where;\n      }\n    };\n  } else if (isText(where)) {\n    var forward = before(node, where) ? function () {\n      return false;\n    } : function () {\n      return node !== where;\n    };\n    var backward = function backward() {\n      return node != where || !iter.pointerBeforeReferenceNode;\n    };\n    predicates = { forward: forward, backward: backward };\n  } else {\n    throw new Error(E_WHERE);\n  }\n\n  while (predicates.forward() && (node = iter.nextNode()) !== null) {\n    count += node.nodeValue.length;\n  }\n\n  while (predicates.backward() && (node = iter.previousNode()) !== null) {\n    count -= node.nodeValue.length;\n  }\n\n  return count;\n}\n\nfunction isNumber(n) {\n  return !isNaN(parseInt(n)) && isFinite(n);\n}\n\nfunction isText(node) {\n  return node.nodeType === TEXT_NODE;\n}\n\nfunction before(ref, node) {\n  if (ref === node) return false;\n\n  var common = null;\n  var left = [ref].concat((0, _ancestors2['default'])(ref)).reverse();\n  var right = [node].concat((0, _ancestors2['default'])(node)).reverse();\n\n  while (left[0] === right[0]) {\n    common = left.shift();\n    right.shift();\n  }\n\n  left = left[0];\n  right = right[0];\n\n  var l = (0, _indexOf2['default'])(common.childNodes, left);\n  var r = (0, _indexOf2['default'])(common.childNodes, right);\n\n  return l > r;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJzZWVrIiwiRV9TSE9XIiwiRV9XSEVSRSIsIlNIT1dfVEVYVCIsIlRFWFRfTk9ERSIsIml0ZXIiLCJ3aGVyZSIsIndoYXRUb1Nob3ciLCJFcnJvciIsImNvdW50Iiwibm9kZSIsInJlZmVyZW5jZU5vZGUiLCJwcmVkaWNhdGVzIiwiaXNOdW1iZXIiLCJmb3J3YXJkIiwiYmFja3dhcmQiLCJpc1RleHQiLCJiZWZvcmUiLCJwb2ludGVyQmVmb3JlUmVmZXJlbmNlTm9kZSIsIm5leHROb2RlIiwibm9kZVZhbHVlIiwibGVuZ3RoIiwicHJldmlvdXNOb2RlIiwibiIsImlzTmFOIiwicGFyc2VJbnQiLCJpc0Zpbml0ZSIsIm5vZGVUeXBlIiwicmVmIiwiY29tbW9uIiwibGVmdCIsImNvbmNhdCIsInJldmVyc2UiLCJyaWdodCIsInNoaWZ0IiwibCIsImNoaWxkTm9kZXMiLCJyIl0sIm1hcHBpbmdzIjoiOzs7cUJBVXdCQSxJOztBQVZ4Qjs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQyxTQUFTLDBEQUFmO0FBQ0EsSUFBTUMsVUFBVSxxREFBaEI7O0FBRUEsSUFBTUMsWUFBWSxDQUFsQjtBQUNBLElBQU1DLFlBQVksQ0FBbEI7O0FBR2UsU0FBU0osSUFBVCxDQUFjSyxJQUFkLEVBQW9CQyxLQUFwQixFQUEyQjtBQUN4QyxNQUFJRCxLQUFLRSxVQUFMLEtBQW9CSixTQUF4QixFQUFtQztBQUNqQyxVQUFNLElBQUlLLEtBQUosQ0FBVVAsTUFBVixDQUFOO0FBQ0Q7O0FBRUQsTUFBSVEsUUFBUSxDQUFaO0FBQ0EsTUFBSUMsT0FBT0wsS0FBS00sYUFBaEI7QUFDQSxNQUFJQyxhQUFhLElBQWpCOztBQUVBLE1BQUlDLFNBQVNQLEtBQVQsQ0FBSixFQUFxQjtBQUNuQk0saUJBQWE7QUFDWEUsZUFBUztBQUFBLGVBQU1MLFFBQVFILEtBQWQ7QUFBQSxPQURFO0FBRVhTLGdCQUFVO0FBQUEsZUFBTU4sUUFBUUgsS0FBZDtBQUFBO0FBRkMsS0FBYjtBQUlELEdBTEQsTUFLTyxJQUFJVSxPQUFPVixLQUFQLENBQUosRUFBbUI7QUFDeEIsUUFBSVEsVUFBVUcsT0FBT1AsSUFBUCxFQUFhSixLQUFiLElBQXNCO0FBQUEsYUFBTSxLQUFOO0FBQUEsS0FBdEIsR0FBb0M7QUFBQSxhQUFNSSxTQUFTSixLQUFmO0FBQUEsS0FBbEQ7QUFDQSxRQUFJUyxXQUFXLFNBQVhBLFFBQVc7QUFBQSxhQUFNTCxRQUFRSixLQUFSLElBQWlCLENBQUNELEtBQUthLDBCQUE3QjtBQUFBLEtBQWY7QUFDQU4saUJBQWEsRUFBQ0UsZ0JBQUQsRUFBVUMsa0JBQVYsRUFBYjtBQUNELEdBSk0sTUFJQTtBQUNMLFVBQU0sSUFBSVAsS0FBSixDQUFVTixPQUFWLENBQU47QUFDRDs7QUFFRCxTQUFPVSxXQUFXRSxPQUFYLE1BQXdCLENBQUNKLE9BQU9MLEtBQUtjLFFBQUwsRUFBUixNQUE2QixJQUE1RCxFQUFrRTtBQUNoRVYsYUFBU0MsS0FBS1UsU0FBTCxDQUFlQyxNQUF4QjtBQUNEOztBQUVELFNBQU9ULFdBQVdHLFFBQVgsTUFBeUIsQ0FBQ0wsT0FBT0wsS0FBS2lCLFlBQUwsRUFBUixNQUFpQyxJQUFqRSxFQUF1RTtBQUNyRWIsYUFBU0MsS0FBS1UsU0FBTCxDQUFlQyxNQUF4QjtBQUNEOztBQUVELFNBQU9aLEtBQVA7QUFDRDs7QUFHRCxTQUFTSSxRQUFULENBQWtCVSxDQUFsQixFQUFxQjtBQUNuQixTQUFPLENBQUNDLE1BQU1DLFNBQVNGLENBQVQsQ0FBTixDQUFELElBQXVCRyxTQUFTSCxDQUFULENBQTlCO0FBQ0Q7O0FBR0QsU0FBU1AsTUFBVCxDQUFnQk4sSUFBaEIsRUFBc0I7QUFDcEIsU0FBT0EsS0FBS2lCLFFBQUwsS0FBa0J2QixTQUF6QjtBQUNEOztBQUdELFNBQVNhLE1BQVQsQ0FBZ0JXLEdBQWhCLEVBQXFCbEIsSUFBckIsRUFBMkI7QUFDekIsTUFBSWtCLFFBQVFsQixJQUFaLEVBQWtCLE9BQU8sS0FBUDs7QUFFbEIsTUFBSW1CLFNBQVMsSUFBYjtBQUNBLE1BQUlDLE9BQU8sQ0FBQ0YsR0FBRCxFQUFNRyxNQUFOLENBQWEsNEJBQVVILEdBQVYsQ0FBYixFQUE2QkksT0FBN0IsRUFBWDtBQUNBLE1BQUlDLFFBQVEsQ0FBQ3ZCLElBQUQsRUFBT3FCLE1BQVAsQ0FBYyw0QkFBVXJCLElBQVYsQ0FBZCxFQUErQnNCLE9BQS9CLEVBQVo7O0FBRUEsU0FBT0YsS0FBSyxDQUFMLE1BQVlHLE1BQU0sQ0FBTixDQUFuQixFQUE2QjtBQUMzQkosYUFBU0MsS0FBS0ksS0FBTCxFQUFUO0FBQ0FELFVBQU1DLEtBQU47QUFDRDs7QUFFREosU0FBT0EsS0FBSyxDQUFMLENBQVA7QUFDQUcsVUFBUUEsTUFBTSxDQUFOLENBQVI7O0FBRUEsTUFBSUUsSUFBSSwwQkFBUU4sT0FBT08sVUFBZixFQUEyQk4sSUFBM0IsQ0FBUjtBQUNBLE1BQUlPLElBQUksMEJBQVFSLE9BQU9PLFVBQWYsRUFBMkJILEtBQTNCLENBQVI7O0FBRUEsU0FBT0UsSUFBSUUsQ0FBWDtBQUNEIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFuY2VzdG9ycyBmcm9tICdhbmNlc3RvcnMnXG5pbXBvcnQgaW5kZXhPZiBmcm9tICdpbmRleC1vZidcblxuY29uc3QgRV9TSE9XID0gJ0FyZ3VtZW50IDEgb2Ygc2VlayBtdXN0IHVzZSBmaWx0ZXIgTm9kZUZpbHRlci5TSE9XX1RFWFQuJ1xuY29uc3QgRV9XSEVSRSA9ICdBcmd1bWVudCAyIG9mIHNlZWsgbXVzdCBiZSBhIG51bWJlciBvciBhIFRleHQgTm9kZS4nXG5cbmNvbnN0IFNIT1dfVEVYVCA9IDRcbmNvbnN0IFRFWFRfTk9ERSA9IDNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzZWVrKGl0ZXIsIHdoZXJlKSB7XG4gIGlmIChpdGVyLndoYXRUb1Nob3cgIT09IFNIT1dfVEVYVCkge1xuICAgIHRocm93IG5ldyBFcnJvcihFX1NIT1cpXG4gIH1cblxuICBsZXQgY291bnQgPSAwXG4gIGxldCBub2RlID0gaXRlci5yZWZlcmVuY2VOb2RlXG4gIGxldCBwcmVkaWNhdGVzID0gbnVsbFxuXG4gIGlmIChpc051bWJlcih3aGVyZSkpIHtcbiAgICBwcmVkaWNhdGVzID0ge1xuICAgICAgZm9yd2FyZDogKCkgPT4gY291bnQgPCB3aGVyZSxcbiAgICAgIGJhY2t3YXJkOiAoKSA9PiBjb3VudCA+IHdoZXJlLFxuICAgIH1cbiAgfSBlbHNlIGlmIChpc1RleHQod2hlcmUpKSB7XG4gICAgbGV0IGZvcndhcmQgPSBiZWZvcmUobm9kZSwgd2hlcmUpID8gKCkgPT4gZmFsc2UgOiAoKSA9PiBub2RlICE9PSB3aGVyZVxuICAgIGxldCBiYWNrd2FyZCA9ICgpID0+IG5vZGUgIT0gd2hlcmUgfHwgIWl0ZXIucG9pbnRlckJlZm9yZVJlZmVyZW5jZU5vZGVcbiAgICBwcmVkaWNhdGVzID0ge2ZvcndhcmQsIGJhY2t3YXJkfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihFX1dIRVJFKVxuICB9XG5cbiAgd2hpbGUgKHByZWRpY2F0ZXMuZm9yd2FyZCgpICYmIChub2RlID0gaXRlci5uZXh0Tm9kZSgpKSAhPT0gbnVsbCkge1xuICAgIGNvdW50ICs9IG5vZGUubm9kZVZhbHVlLmxlbmd0aFxuICB9XG5cbiAgd2hpbGUgKHByZWRpY2F0ZXMuYmFja3dhcmQoKSAmJiAobm9kZSA9IGl0ZXIucHJldmlvdXNOb2RlKCkpICE9PSBudWxsKSB7XG4gICAgY291bnQgLT0gbm9kZS5ub2RlVmFsdWUubGVuZ3RoXG4gIH1cblxuICByZXR1cm4gY291bnRcbn1cblxuXG5mdW5jdGlvbiBpc051bWJlcihuKSB7XG4gIHJldHVybiAhaXNOYU4ocGFyc2VJbnQobikpICYmIGlzRmluaXRlKG4pXG59XG5cblxuZnVuY3Rpb24gaXNUZXh0KG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IFRFWFRfTk9ERVxufVxuXG5cbmZ1bmN0aW9uIGJlZm9yZShyZWYsIG5vZGUpIHtcbiAgaWYgKHJlZiA9PT0gbm9kZSkgcmV0dXJuIGZhbHNlXG5cbiAgbGV0IGNvbW1vbiA9IG51bGxcbiAgbGV0IGxlZnQgPSBbcmVmXS5jb25jYXQoYW5jZXN0b3JzKHJlZikpLnJldmVyc2UoKVxuICBsZXQgcmlnaHQgPSBbbm9kZV0uY29uY2F0KGFuY2VzdG9ycyhub2RlKSkucmV2ZXJzZSgpXG5cbiAgd2hpbGUgKGxlZnRbMF0gPT09IHJpZ2h0WzBdKSB7XG4gICAgY29tbW9uID0gbGVmdC5zaGlmdCgpXG4gICAgcmlnaHQuc2hpZnQoKVxuICB9XG5cbiAgbGVmdCA9IGxlZnRbMF1cbiAgcmlnaHQgPSByaWdodFswXVxuXG4gIGxldCBsID0gaW5kZXhPZihjb21tb24uY2hpbGROb2RlcywgbGVmdClcbiAgbGV0IHIgPSBpbmRleE9mKGNvbW1vbi5jaGlsZE5vZGVzLCByaWdodClcblxuICByZXR1cm4gbCA+IHJcbn1cbiJdfQ==","module.exports = require('./lib')['default'];\n","import wickedElements from 'wicked-elements'\nimport seek from 'dom-seek'\nimport {saveQuoteNote} from './save-note-event.js'\nlet rangeId = 0\n\nwickedElements.define('reader-highlight', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const rangeId = this.element.dataset.rangeId\n    const selected = this.element.classList.contains('Highlight--selected')\n    if (rangeId && !selected) {\n      document\n        .querySelectorAll(`[data-range-id=\"${rangeId}\"]`)\n        .forEach(element => element.classList.add('Highlight--selected'))\n      document.body.dispatchEvent(\n        new window.CustomEvent('reader:highlight-selected', {\n          detail: { rangeId }\n        })\n      )\n    } else if (selected) {\n      document\n        .querySelectorAll(`[data-range-id=\"${rangeId}\"]`)\n        .forEach(element => element.classList.remove('Highlight--selected'))\n      document.body.dispatchEvent(\n        new window.CustomEvent('reader:highlight-deselected', {\n          detail: { rangeId }\n        })\n      )\n    }\n  }\n})\n\nwickedElements.define('[is=\"remove-highlight-button\"]', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.element.addEventListener('click', this)\n    document.body.addEventListener('reader:highlight-selected', this)\n    document.body.addEventListener('reader:highlight-deselected', this)\n    this.element.disabled = true\n  },\n  onclick (event) {\n    document\n      .querySelectorAll(\n        `reader-highlight[data-range-id=\"${this.element.dataset.rangeId}\"]`\n      )\n      .forEach(element => {\n        const range = document.createRange()\n        range.setStartBefore(element.firstChild)\n        range.setEndAfter(element.lastChild)\n        const fragment = range.extractContents()\n        element.parentElement.replaceChild(fragment, element)\n      })\n  },\n  'onreader:highlight-selected': function (event) {\n    console.log(event)\n    this.element.disabled = false\n    this.element.dataset.rangeId = event.detail.rangeId\n  },\n  'onreader:highlight-deselected': function (event) {\n    console.log(event)\n    this.element.disabled = true\n    this.element.dataset.rangeId = null\n  }\n})\n\nwickedElements.define('[is=\"highlight-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const selection = window.getSelection()\n    if (selection.isCollapsed) return null\n    let range\n    if (selection.rangeCount > 1) {\n      const endRange = selection.getRangeAt(selection.rangeCount - 1)\n      range = selection.getRangeAt(0)\n      range.setEnd(endRange.endContainer, endRange.endOffset)\n    } else {\n      range = selection.getRangeAt(0)\n    }\n    if (range.startContainer.parentElement.closest('[data-reader]')) { return null }\n    const ranges = getRanges(range)\n    const html = serializeRange(range)\n    const texts = ranges.map(range => range.toString())\n    texts.forEach(rangeString => highlightString(rangeString, rangeId))\n    const note = `<blockquote>${html}</blockquote>`\n    let startXpath\n    if (range.startContainer.closest) {\n      startXpath = range.startContainer.closest('[data-xpath]').dataset.xpath\n    } else {\n      startXpath = range.startContainer.parentElement.closest('[data-xpath]').dataset.xpath\n    }\n    let endXpath\n    if (range.endContainer.closest) {\n      endXpath = range.endContainer.closest('[data-xpath]').dataset.xpath\n    } else {\n      endXpath = range.endContainer.parentElement.closest('[data-xpath]').dataset.xpath\n    }\n    saveQuoteNote(note, texts, startXpath, endXpath, rangeId)\n    // Clean up\n    selection.collapseToStart()\n    rangeId = rangeId + 1\n  }\n})\n\nfunction serializeRange (range) {\n  const placeholder = document.createElement('div')\n  const fragment = range.cloneContents()\n  fragment.querySelectorAll('[data-reader]').forEach(element => {\n    element.parentElement.removeChild(element)\n  })\n  fragment.querySelectorAll('reader-highlight').forEach(element => {\n    element.replaceWith(element.textContent)\n  })\n  placeholder.appendChild(fragment)\n  return placeholder.innerHTML\n}\n\nfunction getRanges (range) {\n  const end = range.endContainer\n  const start = range.startContainer\n  const iterator = document.createNodeIterator(\n    document.getElementById('chapter'),\n    window.NodeFilter.SHOW_ALL\n  )\n  while (iterator.referenceNode !== start) {\n    iterator.nextNode()\n  }\n  const ranges = []\n  let newRange = document.createRange()\n  newRange.setStart(range.startContainer, range.startOffset)\n  while (iterator.referenceNode !== end) {\n    const ref = iterator.referenceNode\n    if (newRange && ref.matches && ref.matches('[data-reader]')) {\n      newRange.setEndBefore(ref)\n      ranges.push(newRange)\n      newRange = undefined\n      iterator.nextNode()\n    } else if (ref.parentElement.closest('[data-reader]')) {\n      iterator.nextNode()\n    } else if (!newRange) {\n      newRange = document.createRange()\n      newRange.setStartBefore(ref)\n      iterator.nextNode()\n    } else {\n      iterator.nextNode()\n    }\n  }\n  if (newRange) {\n    newRange.setEnd(end, range.endOffset)\n    ranges.push(newRange)\n  }\n  return ranges\n}\n\nfunction highlightString (text, rangeId) {\n  const offset = document.body.textContent.indexOf(text)\n  const length = text.length\n  const iterator = document.createNodeIterator(\n    document.body,\n    window.NodeFilter.SHOW_TEXT\n  )\n  function split (where) {\n    const count = seek(iterator, where)\n    if (count !== where) {\n      // Split the text at the offset\n      iterator.referenceNode.splitText(where - count)\n\n      // Seek to the exact offset.\n      seek(iterator, where - count)\n    }\n    return iterator.referenceNode\n  }\n  split(offset)\n  const end = split(length)\n  const nodeCollector = document.createNodeIterator(\n    document.body,\n    window.NodeFilter.SHOW_TEXT\n  )\n  seek(nodeCollector, offset)\n  var nodes = []\n  while (nodeCollector.referenceNode !== end) {\n    nodes.push(nodeCollector.nextNode())\n  }\n  // nodes = nodes.filter((node) => !node.parentElement.matches('[data-reader]'))\n  for (var i = 0; i < nodes.length; i++) {\n    const node = nodes[i]\n    if (!node.parentElement.closest('[data-reader]') && !node.parentElement.closest('reader-highlight')) {\n      // Create a highlight\n      const highlight = document.createElement('reader-highlight')\n      highlight.dataset.rangeId = rangeId\n      highlight.classList.add('Highlight')\n\n      // Wrap it around the text node\n      node.parentNode.replaceChild(highlight, node)\n      highlight.appendChild(node)\n    }\n  }\n}\n\nwindow.highlightString = highlightString\n","export function saveXpathNote (note, xpath) {\n  // Needs publication url (context) and document url (inReplyTo)\n  const payload = {\n    type: 'Note',\n    'oa:hasSelector': {\n      type: 'XPathSelector',\n      value: xpath\n    },\n    content: note\n  }\n  console.log('saving: ', payload)\n  // Receiver should find data-for that xpath and add data-act-id\n  document.body.dispatchEvent(\n    new window.CustomEvent('reader:save-note', {\n      detail: { type: 'Create', object: payload }\n    })\n  )\n}\n\nexport function updateXpathNote (note, xpath, actId) {\n  const payload = {\n    type: 'Note',\n    id: actId,\n    'oa:hasSelector': {\n      type: 'XPathSelector',\n      value: xpath\n    },\n    content: note\n  }\n  console.log('updating: ', payload)\n  document.body.dispatchEvent(\n    new window.CustomEvent('reader:update-note', {\n      detail: { type: 'Update', object: payload }\n    })\n  )\n}\n\nexport function saveQuoteNote (note, texts, startElement, endElement, rangeId) {\n  // Needs publication url (context) and document url (inReplyTo)\n  const payload = {\n    type: 'Note',\n    'oa:hasSelector': {\n      type: 'reader:HighlightSelector',\n      startElement,\n      endElement,\n      rangeId,\n      value: texts\n    },\n    content: note\n  }\n  console.log(payload)\n  // Receiver should update highlight data-range-id\n  document.body.dispatchEvent(\n    new window.CustomEvent('reader:save-note', {\n      detail: { type: 'Create', object: payload }\n    })\n  )\n}\n","import wickedElements from 'wicked-elements'\n\nwickedElements.define('.Marker-textarea', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.parent = this.el.closest('.Marker')\n    this.el.addEventListener('change', this)\n  },\n  onchange (event) {\n    this.parent.classList.add('Marker--hasContent')\n  }\n})\n\nwickedElements.define('[is=\"marker-note\"]', {\n  init (event) {\n    const element = (this.el = event.currentTarget)\n    const container = this.el.querySelector('.MarkerNote-textarea')\n    this.quill = new window.Quill(container, {\n      modules: {\n        toolbar: [\n          ['bold', 'italic', 'underline'],\n          ['image', 'code-block'],\n          ['link', 'blockquote'],\n          [{ list: 'ordered' }, { list: 'bullet' }],\n          ['clean']\n        ]\n      },\n      theme: 'snow'\n    })\n    this.toolbar = this.el.querySelector('.ql-toolbar')\n    const onFocus = this.onfocus\n    const onBlur = this.onblur\n    this.quill.on('selection-change', function (range, oldRange, source) {\n      if (range) {\n        onFocus(element)\n      } else {\n        onBlur(element)\n      }\n    })\n    this.quill.on('text-change', function () {\n      element.parentElement.classList.add('Marker--hasContent')\n    })\n    const button = document.createElement('button')\n    button.textContent = 'Delete'\n    button.classList.add('TextButton')\n    button.classList.add('TextButton--noteDelete')\n    button.addEventListener('click', event => {\n      this.el.parentElement.removeChild(this.el)\n    })\n    button.dataset.noteDelete = 'true'\n    this.el.appendChild(button)\n  },\n  onfocus (element) {\n    element.classList.add('MarkerNote--hasFocus')\n  },\n  onblur (element) {\n    element.classList.remove('MarkerNote--hasFocus')\n  }\n})\n\nfunction marker (xpath) {\n  const form = document.createElement('form')\n  form.setAttribute('is', 'marker-note')\n  form.dataset.for = xpath\n  form.dataset.reader = 'true'\n  form.classList.add('MarkerNote')\n  form.id = 'MarkerNote-' + xpath\n  const textareaId = 'MarkerNote-text-' + xpath\n  form.dataset.newNote = 'true'\n  form.innerHTML = `<div class=\"MarkerNote-textarea\" id=\"${textareaId}\" data-reader=\"true\" aria-label=\"Sidebar note\"></div>`\n  const button = document.createElement('button')\n  button.textContent = 'Cancel'\n  button.classList.add('TextButton')\n  button.classList.add('TextButton--noteButton')\n  button.addEventListener('click', event => {\n    form.parentElement.removeChild(form)\n  })\n  button.dataset.noteCancel = 'true'\n  form.appendChild(button)\n  return form\n}\n","import wickedElements from 'wicked-elements'\n// From https://developer.mozilla.org/en-US/docs/Web/Events/resize\nfunction throttle (type, name, obj) {\n  obj = obj || window\n  var running = false\n  const func = function () {\n    if (running) {\n      return\n    }\n    running = true\n    window.requestAnimationFrame(function () {\n      obj.dispatchEvent(new window.CustomEvent(name))\n      running = false\n    })\n  }\n  obj.addEventListener(type, func)\n}\nthrottle('resize', 'optimizedResize')\n\nwickedElements.define('#sidebar', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.setSize()\n    window.addEventListener('optimizedResize', this)\n  },\n  onoptimizedResize () {\n    this.setSize()\n  },\n  setSize () {\n    const size = this.element.offsetWidth\n    document.body.style.setProperty('--sidebar-width', size + 'px')\n    if (size < 200) {\n      document.body.classList.add('Layout--reader-no-sidebar')\n    } else {\n      document.body.classList.remove('Layout--reader-no-sidebar')\n    }\n  }\n})\n","/*! (c) Andrea Giammarchi - ISC */\nvar self = this || /* istanbul ignore next */ {};\ntry { self.WeakMap = WeakMap; }\ncatch (WeakMap) {\n  // this could be better but 90% of the time\n  // it's everything developers need as fallback\n  self.WeakMap = (function (id, Object) {'use strict';\n    var dP = Object.defineProperty;\n    var hOP = Object.hasOwnProperty;\n    var proto = WeakMap.prototype;\n    proto.delete = function (key) {\n      return this.has(key) && delete key[this._];\n    };\n    proto.get = function (key) {\n      return this.has(key) ? key[this._] : void 0;\n    };\n    proto.has = function (key) {\n      return hOP.call(key, this._);\n    };\n    proto.set = function (key, value) {\n      dP(key, this._, {configurable: true, value: value});\n      return this;\n    };\n    return WeakMap;\n    function WeakMap(iterable) {\n      dP(this, '_', {value: '_@ungap/weakmap' + id++});\n      if (iterable)\n        iterable.forEach(add, this);\n    }\n    function add(pair) {\n      this.set(pair[0], pair[1]);\n    }\n  }(Math.random(), Object));\n}\nexport default self.WeakMap;\n","/*! (c) Andrea Giammarchi - ISC */\nvar templateLiteral = (function () {'use strict';\n  var RAW = 'raw';\n  var isNoOp = typeof document !== 'object';\n  var templateLiteral = function (tl) {\n    if (\n      // for badly transpiled literals\n      !(RAW in tl) ||\n      // for some version of TypeScript\n      tl.propertyIsEnumerable(RAW) ||\n      // and some other version of TypeScript\n      !Object.isFrozen(tl[RAW]) ||\n      (\n        // or for Firefox < 55\n        /Firefox\\/(\\d+)/.test(\n          (document.defaultView.navigator || {}).userAgent\n        ) &&\n        parseFloat(RegExp.$1) < 55\n      )\n    ) {\n      var forever = {};\n      templateLiteral = function (tl) {\n        for (var key = '.', i = 0; i < tl.length; i++)\n          key += tl[i].length + '.' + tl[i];\n        return forever[key] || (forever[key] = tl);\n      };\n    } else {\n      isNoOp = true;\n    }\n    return TL(tl);\n  };\n  return TL;\n  function TL(tl) {\n    return isNoOp ? tl : templateLiteral(tl);\n  }\n}());\nexport default templateLiteral;\n","import unique from '@ungap/template-literal';\n\nexport default function (template) {\n  var length = arguments.length;\n  var args = [unique(template)];\n  var i = 1;\n  while (i < length)\n    args.push(arguments[i++]);\n  return args;\n};\n","/*! (c) Andrea Giammarchi - ISC */\nvar Wire = (function (slice, proto) {\n\n  proto = Wire.prototype;\n\n  proto.ELEMENT_NODE = 1;\n  proto.nodeType = 111;\n\n  proto.remove = function (keepFirst) {\n    var childNodes = this.childNodes;\n    var first = this.firstChild;\n    var last = this.lastChild;\n    this._ = null;\n    if (keepFirst && childNodes.length === 2) {\n      last.parentNode.removeChild(last);\n    } else {\n      var range = this.ownerDocument.createRange();\n      range.setStartBefore(keepFirst ? childNodes[1] : first);\n      range.setEndAfter(last);\n      range.deleteContents();\n    }\n    return first;\n  };\n\n  proto.valueOf = function (forceAppend) {\n    var fragment = this._;\n    var noFragment = fragment == null;\n    if (noFragment)\n      fragment = (this._ = this.ownerDocument.createDocumentFragment());\n    if (noFragment || forceAppend) {\n      for (var n = this.childNodes, i = 0, l = n.length; i < l; i++)\n        fragment.appendChild(n[i]);\n    }\n    return fragment;\n  };\n\n  return Wire;\n\n  function Wire(childNodes) {\n    var nodes = (this.childNodes = slice.call(childNodes, 0));\n    this.firstChild = nodes[0];\n    this.lastChild = nodes[nodes.length - 1];\n    this.ownerDocument = nodes[0].ownerDocument;\n    this._ = null;\n  }\n\n}([].slice));\nexport default Wire;\n","import Wire from 'hyperhtml-wire';\n\nconst {isArray} = Array;\nconst wireType = Wire.prototype.nodeType;\n\nexport {\n  Wire,\n  isArray,\n  wireType\n};\n","/*! (c) Andrea Giammarchi - ISC */\nvar createContent = (function (document) {'use strict';\n  var FRAGMENT = 'fragment';\n  var TEMPLATE = 'template';\n  var HAS_CONTENT = 'content' in create(TEMPLATE);\n\n  var createHTML = HAS_CONTENT ?\n    function (html) {\n      var template = create(TEMPLATE);\n      template.innerHTML = html;\n      return template.content;\n    } :\n    function (html) {\n      var content = create(FRAGMENT);\n      var template = create(TEMPLATE);\n      var childNodes = null;\n      if (/^[^\\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(html)) {\n        var selector = RegExp.$1;\n        template.innerHTML = '<table>' + html + '</table>';\n        childNodes = template.querySelectorAll(selector);\n      } else {\n        template.innerHTML = html;\n        childNodes = template.childNodes;\n      }\n      append(content, childNodes);\n      return content;\n    };\n\n  return function createContent(markup, type) {\n    return (type === 'svg' ? createSVG : createHTML)(markup);\n  };\n\n  function append(root, childNodes) {\n    var length = childNodes.length;\n    while (length--)\n      root.appendChild(childNodes[0]);\n  }\n\n  function create(element) {\n    return element === FRAGMENT ?\n      document.createDocumentFragment() :\n      document.createElementNS('http://www.w3.org/1999/xhtml', element);\n  }\n\n  // it could use createElementNS when hasNode is there\n  // but this fallback is equally fast and easier to maintain\n  // it is also battle tested already in all IE\n  function createSVG(svg) {\n    var content = create(FRAGMENT);\n    var template = create('div');\n    template.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + svg + '</svg>';\n    append(content, template.firstChild.childNodes);\n    return content;\n  }\n\n}(document));\nexport default createContent;\n","/*! (c) Andrea Giammarchi - ISC */\nvar self = this || /* istanbul ignore next */ {};\ntry { self.Map = Map; }\ncatch (Map) {\n  self.Map = function Map() {\n    var i = 0;\n    var k = [];\n    var v = [];\n    return {\n      delete: function (key) {\n        var had = contains(key);\n        if (had) {\n          k.splice(i, 1);\n          v.splice(i, 1);\n        }\n        return had;\n      },\n      get: function get(key) {\n        return contains(key) ? v[i] : void 0;\n      },\n      has: function has(key) {\n        return contains(key);\n      },\n      set: function set(key, value) {\n        v[contains(key) ? i : (k.push(key) - 1)] = value;\n        return this;\n      }\n    };\n    function contains(v) {\n      i = k.indexOf(v);\n      return -1 < i;\n    }\n  };\n}\nexport default self.Map;\n","import Map from '@ungap/essential-map';\n\nexport const append = (get, parent, children, start, end, before) => {\n  if ((end - start) < 2)\n    parent.insertBefore(get(children[start], 1), before);\n  else {\n    const fragment = parent.ownerDocument.createDocumentFragment();\n    while (start < end)\n      fragment.appendChild(get(children[start++], 1));\n    parent.insertBefore(fragment, before);\n  }\n};\n\nexport const eqeq = (a, b) => a == b;\n\nexport const identity = O => O;\n\nexport const indexOf = (\n  moreNodes,\n  moreStart,\n  moreEnd,\n  lessNodes,\n  lessStart,\n  lessEnd,\n  compare\n) => {\n  const length = lessEnd - lessStart;\n  /* istanbul ignore if */\n  if (length < 1)\n    return -1;\n  while ((moreEnd - moreStart) >= length) {\n    let m = moreStart;\n    let l = lessStart;\n    while (\n      m < moreEnd &&\n      l < lessEnd &&\n      compare(moreNodes[m], lessNodes[l])\n    ) {\n      m++;\n      l++;\n    }\n    if (l === lessEnd)\n      return moreStart;\n    moreStart = m + 1;\n  }\n  return -1;\n};\n\nexport const isReversed = (\n  futureNodes,\n  futureEnd,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  compare\n) => {\n  while (\n    currentStart < currentEnd &&\n    compare(\n      currentNodes[currentStart],\n      futureNodes[futureEnd - 1]\n    )) {\n      currentStart++;\n      futureEnd--;\n    };\n  return futureEnd === 0;\n};\n\nexport const next = (get, list, i, length, before) => i < length ?\n              get(list[i], 0) :\n              (0 < i ?\n                get(list[i - 1], -0).nextSibling :\n                before);\n\nexport const remove = (get, parent, children, start, end) => {\n  if ((end - start) < 2)\n    parent.removeChild(get(children[start], -1));\n  else {\n    const range = parent.ownerDocument.createRange();\n    range.setStartBefore(get(children[start], -1));\n    range.setEndAfter(get(children[end - 1], -1));\n    range.deleteContents();\n  }\n};\n\n// - - - - - - - - - - - - - - - - - - -\n// diff related constants and utilities\n// - - - - - - - - - - - - - - - - - - -\n\nconst DELETION = -1;\nconst INSERTION = 1;\nconst SKIP = 0;\nconst SKIP_OND = 50;\n\nconst HS = (\n  futureNodes,\n  futureStart,\n  futureEnd,\n  futureChanges,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  currentChanges\n) => {\n\n  let k = 0;\n  /* istanbul ignore next */\n  let minLen = futureChanges < currentChanges ? futureChanges : currentChanges;\n  const link = Array(minLen++);\n  const tresh = Array(minLen);\n  tresh[0] = -1;\n\n  for (let i = 1; i < minLen; i++)\n    tresh[i] = currentEnd;\n\n  const keymap = new Map;\n  for (let i = currentStart; i < currentEnd; i++)\n    keymap.set(currentNodes[i], i);\n\n  for (let i = futureStart; i < futureEnd; i++) {\n    const idxInOld = keymap.get(futureNodes[i]);\n    if (idxInOld != null) {\n      k = findK(tresh, minLen, idxInOld);\n      /* istanbul ignore else */\n      if (-1 < k) {\n        tresh[k] = idxInOld;\n        link[k] = {\n          newi: i,\n          oldi: idxInOld,\n          prev: link[k - 1]\n        };\n      }\n    }\n  }\n\n  k = --minLen;\n  --currentEnd;\n  while (tresh[k] > currentEnd) --k;\n\n  minLen = currentChanges + futureChanges - k;\n  const diff = Array(minLen);\n  let ptr = link[k];\n  --futureEnd;\n  while (ptr) {\n    const {newi, oldi} = ptr;\n    while (futureEnd > newi) {\n      diff[--minLen] = INSERTION;\n      --futureEnd;\n    }\n    while (currentEnd > oldi) {\n      diff[--minLen] = DELETION;\n      --currentEnd;\n    }\n    diff[--minLen] = SKIP;\n    --futureEnd;\n    --currentEnd;\n    ptr = ptr.prev;\n  }\n  while (futureEnd >= futureStart) {\n    diff[--minLen] = INSERTION;\n    --futureEnd;\n  }\n  while (currentEnd >= currentStart) {\n    diff[--minLen] = DELETION;\n    --currentEnd;\n  }\n  return diff;\n};\n\n// this is pretty much the same petit-dom code without the delete map part\n// https://github.com/yelouafi/petit-dom/blob/bd6f5c919b5ae5297be01612c524c40be45f14a7/src/vdom.js#L556-L561\nconst OND = (\n  futureNodes,\n  futureStart,\n  rows,\n  currentNodes,\n  currentStart,\n  cols,\n  compare\n) => {\n  const length = rows + cols;\n  const v = [];\n  let d, k, r, c, pv, cv, pd;\n  outer: for (d = 0; d <= length; d++) {\n    /* istanbul ignore if */\n    if (d > SKIP_OND)\n      return null;\n    pd = d - 1;\n    /* istanbul ignore next */\n    pv = d ? v[d - 1] : [0, 0];\n    cv = v[d] = [];\n    for (k = -d; k <= d; k += 2) {\n      if (k === -d || (k !== d && pv[pd + k - 1] < pv[pd + k + 1])) {\n        c = pv[pd + k + 1];\n      } else {\n        c = pv[pd + k - 1] + 1;\n      }\n      r = c - k;\n      while (\n        c < cols &&\n        r < rows &&\n        compare(\n          currentNodes[currentStart + c],\n          futureNodes[futureStart + r]\n        )\n      ) {\n        c++;\n        r++;\n      }\n      if (c === cols && r === rows) {\n        break outer;\n      }\n      cv[d + k] = c;\n    }\n  }\n\n  const diff = Array(d / 2 + length / 2);\n  let diffIdx = diff.length - 1;\n  for (d = v.length - 1; d >= 0; d--) {\n    while (\n      c > 0 &&\n      r > 0 &&\n      compare(\n        currentNodes[currentStart + c - 1],\n        futureNodes[futureStart + r - 1]\n      )\n    ) {\n      // diagonal edge = equality\n      diff[diffIdx--] = SKIP;\n      c--;\n      r--;\n    }\n    if (!d)\n      break;\n    pd = d - 1;\n    /* istanbul ignore next */\n    pv = d ? v[d - 1] : [0, 0];\n    k = c - r;\n    if (k === -d || (k !== d && pv[pd + k - 1] < pv[pd + k + 1])) {\n      // vertical edge = insertion\n      r--;\n      diff[diffIdx--] = INSERTION;\n    } else {\n      // horizontal edge = deletion\n      c--;\n      diff[diffIdx--] = DELETION;\n    }\n  }\n  return diff;\n};\n\nconst applyDiff = (\n  diff,\n  get,\n  parentNode,\n  futureNodes,\n  futureStart,\n  currentNodes,\n  currentStart,\n  currentLength,\n  before\n) => {\n  const live = new Map;\n  const length = diff.length;\n  let currentIndex = currentStart;\n  let i = 0;\n  while (i < length) {\n    switch (diff[i++]) {\n      case SKIP:\n        futureStart++;\n        currentIndex++;\n        break;\n      case INSERTION:\n        // TODO: bulk appends for sequential nodes\n        live.set(futureNodes[futureStart], 1);\n        append(\n          get,\n          parentNode,\n          futureNodes,\n          futureStart++,\n          futureStart,\n          currentIndex < currentLength ?\n            get(currentNodes[currentIndex], 0) :\n            before\n        );\n        break;\n      case DELETION:\n        currentIndex++;\n        break;\n    }\n  }\n  i = 0;\n  while (i < length) {\n    switch (diff[i++]) {\n      case SKIP:\n        currentStart++;\n        break;\n      case DELETION:\n        // TODO: bulk removes for sequential nodes\n        if (live.has(currentNodes[currentStart]))\n          currentStart++;\n        else\n          remove(\n            get,\n            parentNode,\n            currentNodes,\n            currentStart++,\n            currentStart\n          );\n        break;\n    }\n  }\n};\n\nconst findK = (ktr, length, j) => {\n  let lo = 1;\n  let hi = length;\n  while (lo < hi) {\n    const mid = ((lo + hi) / 2) >>> 0;\n    if (j < ktr[mid])\n      hi = mid;\n    else\n      lo = mid + 1;\n  }\n  return lo;\n}\n\nexport const smartDiff = (\n  get,\n  parentNode,\n  futureNodes,\n  futureStart,\n  futureEnd,\n  futureChanges,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  currentChanges,\n  currentLength,\n  compare,\n  before\n) => {\n  applyDiff(\n    OND(\n      futureNodes,\n      futureStart,\n      futureChanges,\n      currentNodes,\n      currentStart,\n      currentChanges,\n      compare\n    ) ||\n    HS(\n      futureNodes,\n      futureStart,\n      futureEnd,\n      futureChanges,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      currentChanges\n    ),\n    get,\n    parentNode,\n    futureNodes,\n    futureStart,\n    currentNodes,\n    currentStart,\n    currentLength,\n    before\n  );\n};\n","/*! (c) 2018 Andrea Giammarchi (ISC) */\n\nimport {\n  eqeq, identity, indexOf, isReversed, next,\n  append, remove,\n  smartDiff\n} from './utils.js';\n\nconst domdiff = (\n  parentNode,     // where changes happen\n  currentNodes,   // Array of current items/nodes\n  futureNodes,    // Array of future items/nodes\n  options         // optional object with one of the following properties\n                  //  before: domNode\n                  //  compare(generic, generic) => true if same generic\n                  //  node(generic) => Node\n) => {\n  if (!options)\n    options = {};\n\n  const compare = options.compare || eqeq;\n  const get = options.node || identity;\n  const before = options.before == null ? null : get(options.before, 0);\n\n  const currentLength = currentNodes.length;\n  let currentEnd = currentLength;\n  let currentStart = 0;\n\n  let futureEnd = futureNodes.length;\n  let futureStart = 0;\n\n  // common prefix\n  while (\n    currentStart < currentEnd &&\n    futureStart < futureEnd &&\n    compare(currentNodes[currentStart], futureNodes[futureStart])\n  ) {\n    currentStart++;\n    futureStart++;\n  }\n\n  // common suffix\n  while (\n    currentStart < currentEnd &&\n    futureStart < futureEnd &&\n    compare(currentNodes[currentEnd - 1], futureNodes[futureEnd - 1])\n  ) {\n    currentEnd--;\n    futureEnd--;\n  }\n\n  const currentSame = currentStart === currentEnd;\n  const futureSame = futureStart === futureEnd;\n\n  // same list\n  if (currentSame && futureSame)\n    return futureNodes;\n\n  // only stuff to add\n  if (currentSame && futureStart < futureEnd) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      next(get, currentNodes, currentStart, currentLength, before)\n    );\n    return futureNodes;\n  }\n\n  // only stuff to remove\n  if (futureSame && currentStart < currentEnd) {\n    remove(\n      get,\n      parentNode,\n      currentNodes,\n      currentStart,\n      currentEnd\n    );\n    return futureNodes;\n  }\n\n  const currentChanges = currentEnd - currentStart;\n  const futureChanges = futureEnd - futureStart;\n  let i = -1;\n\n  // 2 simple indels: the shortest sequence is a subsequence of the longest\n  if (currentChanges < futureChanges) {\n    i = indexOf(\n      futureNodes,\n      futureStart,\n      futureEnd,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      compare\n    );\n    // inner diff\n    if (-1 < i) {\n      append(\n        get,\n        parentNode,\n        futureNodes,\n        futureStart,\n        i,\n        get(currentNodes[currentStart], 0)\n      );\n      append(\n        get,\n        parentNode,\n        futureNodes,\n        i + currentChanges,\n        futureEnd,\n        next(get, currentNodes, currentEnd, currentLength, before)\n      );\n      return futureNodes;\n    }\n  }\n  /* istanbul ignore else */\n  else if (futureChanges < currentChanges) {\n    i = indexOf(\n      currentNodes,\n      currentStart,\n      currentEnd,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      compare\n    );\n    // outer diff\n    if (-1 < i) {\n      remove(\n        get,\n        parentNode,\n        currentNodes,\n        currentStart,\n        i\n      );\n      remove(\n        get,\n        parentNode,\n        currentNodes,\n        i + futureChanges,\n        currentEnd\n      );\n      return futureNodes;\n    }\n  }\n\n  // common case with one replacement for many nodes\n  // or many nodes replaced for a single one\n  /* istanbul ignore else */\n  if ((currentChanges < 2 || futureChanges < 2)) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      get(currentNodes[currentStart], 0)\n    );\n    remove(\n      get,\n      parentNode,\n      currentNodes,\n      currentStart,\n      currentEnd\n    );\n    return futureNodes;\n  }\n\n  // the half match diff part has been skipped in petit-dom\n  // https://github.com/yelouafi/petit-dom/blob/bd6f5c919b5ae5297be01612c524c40be45f14a7/src/vdom.js#L391-L397\n  // accordingly, I think it's safe to skip in here too\n  // if one day it'll come out like the speediest thing ever to do\n  // then I might add it in here too\n\n  // Extra: before going too fancy, what about reversed lists ?\n  //        This should bail out pretty quickly if that's not the case.\n  if (\n    currentChanges === futureChanges &&\n    isReversed(\n      futureNodes,\n      futureEnd,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      compare\n    )\n  ) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      next(get, currentNodes, currentEnd, currentLength, before)\n    );\n    return futureNodes;\n  }\n\n  // last resort through a smart diff\n  smartDiff(\n    get,\n    parentNode,\n    futureNodes,\n    futureStart,\n    futureEnd,\n    futureChanges,\n    currentNodes,\n    currentStart,\n    currentEnd,\n    currentChanges,\n    currentLength,\n    compare,\n    before\n  );\n\n  return futureNodes;\n};\n\nexport default domdiff;\n","/*! (c) Andrea Giammarchi - ISC */\nvar importNode = (function (\n  document,\n  appendChild,\n  cloneNode,\n  createTextNode,\n  importNode\n) {\n  var native = importNode in document;\n  // IE 11 has problems with cloning templates:\n  // it \"forgets\" empty childNodes. This feature-detects that.\n  var fragment = document.createDocumentFragment();\n  fragment[appendChild](document[createTextNode]('g'));\n  fragment[appendChild](document[createTextNode](''));\n  var content = native ?\n    document[importNode](fragment, true) :\n    fragment[cloneNode](true);\n  return content.childNodes.length < 2 ?\n    function importNode(node, deep) {\n      var clone = node[cloneNode]();\n      for (var\n        childNodes = node.childNodes || [],\n        length = childNodes.length,\n        i = 0; deep && i < length; i++\n      ) {\n        clone[appendChild](importNode(childNodes[i], deep));\n      }\n      return clone;\n    } :\n    (native ?\n      document[importNode] :\n      function (node, deep) {\n        return node[cloneNode](!!deep);\n      }\n    );\n}(\n  document,\n  'appendChild',\n  'cloneNode',\n  'createTextNode',\n  'importNode'\n));\nexport default importNode;\n","// Custom\nvar UID = '-' + Math.random().toFixed(6) + '%';\n//                           Edge issue!\nif (!(function (template, content, tabindex) {\n  return content in template && (\n    (template.innerHTML = '<p ' + tabindex + '=\"' + UID + '\"></p>'),\n    template[content].childNodes[0].getAttribute(tabindex) == UID\n  );\n}(document.createElement('template'), 'content', 'tabindex'))) {\n  UID = '_dt: ' + UID.slice(1, -1) + ';';\n}\nvar UIDC = '<!--' + UID + '-->';\n\n// DOM\nvar COMMENT_NODE = 8;\nvar DOCUMENT_FRAGMENT_NODE = 11;\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\n\nvar SHOULD_USE_TEXT_CONTENT = /^(?:style|textarea)$/i;\nvar VOID_ELEMENTS = /^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;\n\nexport {\n  UID, UIDC,\n  COMMENT_NODE,\n  DOCUMENT_FRAGMENT_NODE,\n  ELEMENT_NODE,\n  TEXT_NODE,\n  SHOULD_USE_TEXT_CONTENT,\n  VOID_ELEMENTS\n};\n","var trim = ''.trim || function () {\n  return String(this).replace(/^\\s+|\\s+/g, '');\n};\nexport default trim;\n","import {UID, UIDC, VOID_ELEMENTS} from './constants.js';\n\nexport default function (template) {\n  return template.join(UIDC)\n          .replace(selfClosing, fullClosing)\n          .replace(attrSeeker, attrReplacer);\n}\n\nvar spaces = ' \\\\f\\\\n\\\\r\\\\t';\nvar almostEverything = '[^ ' + spaces + '\\\\/>\"\\'=]+';\nvar attrName = '[ ' + spaces + ']+' + almostEverything;\nvar tagName = '<([A-Za-z]+[A-Za-z0-9:_-]*)((?:';\nvar attrPartials = '(?:\\\\s*=\\\\s*(?:\\'[^\\']*?\\'|\"[^\"]*?\"|<[^>]*?>|' + almostEverything + '))?)';\n\nvar attrSeeker = new RegExp(tagName + attrName + attrPartials + '+)([ ' + spaces + ']*/?>)', 'g');\nvar selfClosing = new RegExp(tagName + attrName + attrPartials + '*)([ ' + spaces + ']*/>)', 'g');\nvar findAttributes = new RegExp('(' + attrName + '\\\\s*=\\\\s*)([\\'\"]?)' + UIDC + '\\\\2', 'gi');\n\nfunction attrReplacer($0, $1, $2, $3) {\n  return '<' + $1 + $2.replace(findAttributes, replaceAttributes) + $3;\n}\n\nfunction replaceAttributes($0, $1, $2) {\n  return $1 + ($2 || '\"') + UID + ($2 || '\"');\n}\n\nfunction fullClosing($0, $1, $2) {\n  return VOID_ELEMENTS.test($1) ? $0 : ('<' + $1 + $2 + '></' + $1 + '>');\n}\n","import Map from '@ungap/essential-map';\nimport trim from '@ungap/trim';\n\nimport {\n  UID, UIDC,\n  COMMENT_NODE,\n  ELEMENT_NODE,\n  SHOULD_USE_TEXT_CONTENT,\n  TEXT_NODE\n} from './constants.js';\n\nexport {find, parse};\n\nfunction create(type, node, path, name) {\n  return {name: name, node: node, path: path, type: type};\n}\n\nfunction find(node, path) {\n  var length = path.length;\n  var i = 0;\n  while (i < length)\n    node = node.childNodes[path[i++]];\n  return node;\n}\n\nfunction parse(node, holes, parts, path) {\n  var childNodes = node.childNodes;\n  var length = childNodes.length;\n  var i = 0;\n  while (i < length) {\n    var child = childNodes[i];\n    switch (child.nodeType) {\n      case ELEMENT_NODE:\n        var childPath = path.concat(i);\n        parseAttributes(child, holes, parts, childPath);\n        parse(child, holes, parts, childPath);\n        break;\n      case COMMENT_NODE:\n        if (child.textContent === UID) {\n          parts.shift();\n          holes.push(\n            // basicHTML or other non standard engines\n            // might end up having comments in nodes\n            // where they shouldn't, hence this check.\n            SHOULD_USE_TEXT_CONTENT.test(node.nodeName) ?\n              create('text', node, path) :\n              create('any', child, path.concat(i))\n          );\n        }\n        break;\n      case TEXT_NODE:\n        // the following ignore is actually covered by browsers\n        // only basicHTML ends up on previous COMMENT_NODE case\n        // instead of TEXT_NODE because it knows nothing about\n        // special style or textarea behavior\n        /* istanbul ignore if */\n        if (\n          SHOULD_USE_TEXT_CONTENT.test(node.nodeName) &&\n          trim.call(child.textContent) === UIDC\n        ) {\n          parts.shift();\n          holes.push(create('text', node, path));\n        }\n        break;\n    }\n    i++;\n  }\n}\n\nfunction parseAttributes(node, holes, parts, path) {\n  var cache = new Map;\n  var attributes = node.attributes;\n  var remove = [];\n  var array = remove.slice.call(attributes, 0);\n  var length = array.length;\n  var i = 0;\n  while (i < length) {\n    var attribute = array[i++];\n    if (attribute.value === UID) {\n      var name = attribute.name;\n      // the following ignore is covered by IE\n      // and the IE9 double viewBox test\n      /* istanbul ignore else */\n      if (!cache.has(name)) {\n        var realName = parts.shift().replace(/^(?:|[\\S\\s]*?\\s)(\\S+?)\\s*=\\s*['\"]?$/, '$1');\n        var value = attributes[realName] ||\n                      // the following ignore is covered by browsers\n                      // while basicHTML is already case-sensitive\n                      /* istanbul ignore next */\n                      attributes[realName.toLowerCase()];\n        cache.set(name, value);\n        holes.push(create('attr', value, path, realName));\n      }\n      remove.push(attribute);\n    }\n  }\n  length = remove.length;\n  i = 0;\n  while (i < length) {\n    // Edge HTML bug #16878726\n    var attr = remove[i++];\n    if (/^id$/i.test(attr.name))\n      node.removeAttribute(attr.name);\n    // standard browsers would work just fine here\n    else\n      node.removeAttributeNode(attr);\n  }\n\n  // This is a very specific Firefox/Safari issue\n  // but since it should be a not so common pattern,\n  // it's probably worth patching regardless.\n  // Basically, scripts created through strings are death.\n  // You need to create fresh new scripts instead.\n  // TODO: is there any other node that needs such nonsense?\n  var nodeName = node.nodeName;\n  if (/^script$/i.test(nodeName)) {\n    // this used to be like that\n    // var script = createElement(node, nodeName);\n    // then Edge arrived and decided that scripts created\n    // through template documents aren't worth executing\n    // so it became this ... hopefully it won't hurt in the wild\n    var script = document.createElement(nodeName);\n    length = attributes.length;\n    i = 0;\n    while (i < length)\n      script.setAttributeNode(attributes[i++].cloneNode(true));\n    script.textContent = node.textContent;\n    node.parentNode.replaceChild(script, node);\n  }\n}\n","// globals\nimport WeakMap from '@ungap/weakmap';\n\n// utils\nimport createContent from '@ungap/create-content';\nimport importNode from '@ungap/import-node';\nimport trim from '@ungap/trim';\n\n// local\nimport sanitize from './sanitizer.js';\nimport {find, parse} from './walker.js';\n\n// the domtagger \nexport default domtagger;\n\nvar parsed = new WeakMap;\nvar referenced = new WeakMap;\n\nfunction createInfo(options, template) {\n  var markup = sanitize(template);\n  var transform = options.transform;\n  if (transform)\n    markup = transform(markup);\n  var content = createContent(markup, options.type);\n  cleanContent(content);\n  var holes = [];\n  parse(content, holes, template.slice(0), []);\n  var info = {\n    content: content,\n    updates: function (content) {\n      var callbacks = [];\n      var len = holes.length;\n      var i = 0;\n      while (i < len) {\n        var info = holes[i++];\n        var node = find(content, info.path);\n        switch (info.type) {\n          case 'any':\n            callbacks.push(options.any(node, []));\n            break;\n          case 'attr':\n            callbacks.push(options.attribute(node, info.name, info.node));\n            break;\n          case 'text':\n            callbacks.push(options.text(node));\n            node.textContent = '';\n            break;\n        }\n      }\n      return function () {\n        var length = arguments.length;\n        var values = length - 1;\n        var i = 1;\n        if (len !== values) {\n          throw new Error(\n            values + ' values instead of ' + len + '\\n' +\n            template.join(', ')\n          );\n        }\n        while (i < length)\n          callbacks[i - 1](arguments[i++]);\n        return content;\n      };\n    }\n  };\n  parsed.set(template, info);\n  return info;\n}\n\nfunction createDetails(options, template) {\n  var info = parsed.get(template) || createInfo(options, template);\n  var content = importNode.call(document, info.content, true);\n  var details = {\n    content: content,\n    template: template,\n    updates: info.updates(content)\n  };\n  referenced.set(options, details);\n  return details;\n}\n\nfunction domtagger(options) {\n  return function (template) {\n    var details = referenced.get(options);\n    if (details == null || details.template !== template)\n      details = createDetails(options, template);\n    details.updates.apply(null, arguments);\n    return details.content;\n  };\n}\n\nfunction cleanContent(fragment) {\n  var childNodes = fragment.childNodes;\n  var i = childNodes.length;\n  while (i--) {\n    var child = childNodes[i];\n    if (\n      child.nodeType !== 1 &&\n      trim.call(child.textContent).length === 0\n    ) {\n      fragment.removeChild(child);\n    }\n  }\n}\n","/*! (c) Andrea Giammarchi - ISC */\nvar hyperStyle = (function (){'use strict';\n  // from https://github.com/developit/preact/blob/33fc697ac11762a1cb6e71e9847670d047af7ce5/src/varants.js\n  var IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n  var hyphen = /([^A-Z])([A-Z]+)/g;\n  return function hyperStyle(node, original) {\n    return 'ownerSVGElement' in node ? svg(node, original) : update(node.style, false);\n  };\n  function ized($0, $1, $2) {\n    return $1 + '-' + $2.toLowerCase();\n  }\n  function svg(node, original) {\n    var style;\n    if (original)\n      style = original.cloneNode(true);\n    else {\n      node.setAttribute('style', '--hyper:style;');\n      style = node.getAttributeNode('style');\n    }\n    style.value = '';\n    node.setAttributeNode(style);\n    return update(style, true);\n  }\n  function toStyle(object) {\n    var key, css = [];\n    for (key in object)\n      css.push(key.replace(hyphen, ized), ':', object[key], ';');\n    return css.join('');\n  }\n  function update(style, isSVG) {\n    var oldType, oldValue;\n    return function (newValue) {\n      var info, key, styleValue, value;\n      switch (typeof newValue) {\n        case 'object':\n          if (newValue) {\n            if (oldType === 'object') {\n              if (!isSVG) {\n                if (oldValue !== newValue) {\n                  for (key in oldValue) {\n                    if (!(key in newValue)) {\n                      style[key] = '';\n                    }\n                  }\n                }\n              }\n            } else {\n              if (isSVG)\n                style.value = '';\n              else\n                style.cssText = '';\n            }\n            info = isSVG ? {} : style;\n            for (key in newValue) {\n              value = newValue[key];\n              styleValue = typeof value === 'number' &&\n                                  !IS_NON_DIMENSIONAL.test(key) ?\n                                  (value + 'px') : value;\n              if (!isSVG && /^--/.test(key))\n                info.setProperty(key, styleValue);\n              else\n                info[key] = styleValue;\n            }\n            oldType = 'object';\n            if (isSVG)\n              style.value = toStyle((oldValue = info));\n            else\n              oldValue = newValue;\n            break;\n          }\n        default:\n          if (oldValue != newValue) {\n            oldType = 'string';\n            oldValue = newValue;\n            if (isSVG)\n              style.value = newValue || '';\n            else\n              style.cssText = newValue || '';\n          }\n          break;\n      }\n    };\n  }\n}());\nexport default hyperStyle;\n","import createContent from '@ungap/create-content';\nimport domdiff from 'domdiff';\nimport domtagger from 'domtagger';\nimport hyperStyle from 'hyperhtml-style';\n\nimport {wireType, isArray} from './shared.js';\n\nconst OWNER_SVG_ELEMENT = 'ownerSVGElement';\n\n// returns nodes from wires and components\nconst asNode = (item, i) => item.nodeType === wireType ?\n  (\n    (1 / i) < 0 ?\n      (i ? item.remove(true) : item.lastChild) :\n      (i ? item.valueOf(true) : item.firstChild)\n  ) :\n  item\n;\n\n// returns true if domdiff can handle the value\nconst canDiff = value => 'ELEMENT_NODE' in value;\n\n// generic attributes helpers\nconst hyperAttribute = (node, attribute) => {\n  let oldValue;\n  let owner = false;\n  return newValue => {\n    if (oldValue !== newValue) {\n      oldValue = newValue;\n      if (attribute.value !== newValue) {\n        if (newValue == null) {\n          if (owner) {\n            owner = false;\n            node.removeAttributeNode(attribute);\n          }\n          attribute.value = newValue;\n        } else {\n          attribute.value = newValue;\n          if (!owner) {\n            owner = true;\n            node.setAttributeNode(attribute);\n          }\n        }\n      }\n    }\n  };\n};\n\n// events attributes helpers\nconst hyperEvent = (node, name) => {\n  let oldValue;\n  let type = name.slice(2);\n  if (name.toLowerCase() in node)\n    type = type.toLowerCase();\n  return newValue => {\n    if (oldValue !== newValue) {\n      if (oldValue)\n        node.removeEventListener(type, oldValue, false);\n      oldValue = newValue;\n      if (newValue)\n        node.addEventListener(type, newValue, false);\n    }\n  };\n};\n\n// special attributes helpers\nconst hyperProperty = (node, name) => {\n  let oldValue;\n  return newValue => {\n    if (oldValue !== newValue) {\n      oldValue = newValue;\n      if (node[name] !== newValue) {\n        node[name] = newValue;\n        if (newValue == null) {\n          node.removeAttribute(name);\n        }\n      }\n    }\n  };\n};\n\n// special hooks helpers\nconst hyperRef = node => {\n  return ref => {\n    ref.current = node;\n  };\n};\n\n// list of attributes that should not be directly assigned\nconst readOnly = /^(?:form|list)$/i;\n\n// reused every slice time\nconst slice = [].slice;\n\n// simplifies text node creation\nconst text = (node, text) => node.ownerDocument.createTextNode(text);\n\nexport default function Tagger(type) {\n  this.type = type;\n  return domtagger(this);\n}\n\nTagger.prototype = {\n\n  // there are four kind of attributes, and related behavior:\n  //  * events, with a name starting with `on`, to add/remove event listeners\n  //  * special, with a name present in their inherited prototype, accessed directly\n  //  * regular, accessed through get/setAttribute standard DOM methods\n  //  * style, the only regular attribute that also accepts an object as value\n  //    so that you can style=${{width: 120}}. In this case, the behavior has been\n  //    fully inspired by Preact library and its simplicity.\n  attribute(node, name, original) {\n    switch (name) {\n      case 'class':\n        name = 'className';\n      case 'data':\n      case 'props':\n        return hyperProperty(node, name);\n      case 'style':\n        return hyperStyle(node, original, OWNER_SVG_ELEMENT in node);\n      case 'ref':\n        return hyperRef(node);\n      default:\n        if (name.slice(0, 2) === 'on')\n          return hyperEvent(node, name);\n        if (name in node && !(\n          OWNER_SVG_ELEMENT in node || readOnly.test(name)\n        ))\n          return hyperProperty(node, name);\n        return hyperAttribute(node, original.cloneNode(true));\n\n    }\n  },\n\n  // in a hyper(node)`<div>${content}</div>` case\n  // everything could happen:\n  //  * it's a JS primitive, stored as text\n  //  * it's null or undefined, the node should be cleaned\n  //  * it's a promise, update the content once resolved\n  //  * it's an explicit intent, perform the desired operation\n  //  * it's an Array, resolve all values if Promises and/or\n  //    update the node with the resulting list of content\n  any(node, childNodes) {\n    const diffOptions = {node: asNode, before: node};\n    const nodeType = OWNER_SVG_ELEMENT in node ? /* istanbul ignore next */ 'svg' : 'html';\n    let fastPath = false;\n    let oldValue;\n    const anyContent = value => {\n      switch (typeof value) {\n        case 'string':\n        case 'number':\n        case 'boolean':\n          if (fastPath) {\n            if (oldValue !== value) {\n              oldValue = value;\n              childNodes[0].textContent = value;\n            }\n          } else {\n            fastPath = true;\n            oldValue = value;\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              [text(node, value)],\n              diffOptions\n            );\n          }\n          break;\n        case 'function':\n          anyContent(value(node));\n          break;\n        case 'object':\n        case 'undefined':\n          if (value == null) {\n            fastPath = false;\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              [],\n              diffOptions\n            );\n            break;\n          }\n        default:\n          fastPath = false;\n          oldValue = value;\n          if (isArray(value)) {\n            if (value.length === 0) {\n              if (childNodes.length) {\n                childNodes = domdiff(\n                  node.parentNode,\n                  childNodes,\n                  [],\n                  diffOptions\n                );\n              }\n            } else {\n              switch (typeof value[0]) {\n                case 'string':\n                case 'number':\n                case 'boolean':\n                  anyContent(String(value));\n                  break;\n                case 'function':\n                  anyContent(value.map(invoke, node));\n                  break;\n                case 'object':\n                  if (isArray(value[0])) {\n                    value = value.concat.apply([], value);\n                  }\n                default:\n                  childNodes = domdiff(\n                    node.parentNode,\n                    childNodes,\n                    value,\n                    diffOptions\n                  );\n                  break;\n              }\n            }\n          } else if (canDiff(value)) {\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              value.nodeType === 11 ?\n                slice.call(value.childNodes) :\n                [value],\n              diffOptions\n            );\n          } else if ('text' in value) {\n            anyContent(String(value.text));\n          } else if ('any' in value) {\n            anyContent(value.any);\n          } else if ('html' in value) {\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              slice.call(\n                createContent(\n                  [].concat(value.html).join(''),\n                  nodeType\n                ).childNodes\n              ),\n              diffOptions\n            );\n          } else if ('length' in value) {\n            anyContent(slice.call(value));\n          }\n          break;\n      }\n    };\n    return anyContent;\n  },\n\n  // style or textareas don't accept HTML as content\n  // it's pointless to transform or analyze anything\n  // different from text there but it's worth checking\n  // for possible defined intents.\n  text(node) {\n    let oldValue;\n    const textContent = value => {\n      if (oldValue !== value) {\n        oldValue = value;\n        const type = typeof value;\n        if (type === 'object' && value) {\n          if ('text' in value) {\n            textContent(String(value.text));\n          } else if ('any' in value) {\n            textContent(value.any);\n          } else if ('html' in value) {\n            textContent([].concat(value.html).join(''));\n          } else if ('length' in value) {\n            textContent(slice.call(value).join(''));\n          }\n        } else if (type === 'function') {\n          textContent(value(node));\n        } else {\n          node.textContent = value == null ? '' : value;\n        }\n      }\n    };\n    return textContent;\n  }\n};\n\nfunction invoke(callback) {\n  return callback(this);\n}\n","import WeakMap from '@ungap/weakmap';\nimport tta from '@ungap/template-tag-arguments';\nimport {Wire, wireType, isArray} from './shared.js';\nimport Tagger from './tagger.js';\n\nconst wm = new WeakMap;\nconst container = new WeakMap;\n\nlet current = null;\n\n// can be used with any useRef hook\n// returns an `html` and `svg` function\nexport const hook = useRef => ({\n  html: createHook(useRef, html),\n  svg: createHook(useRef, svg)\n});\n\n// generic content render\nexport function render(node, callback) {\n  const value = update.call(this, node, callback);\n  if (container.get(node) !== value) {\n    container.set(node, value);\n    appendClean(node, value);\n  }\n  return node;\n}\n\n// keyed render via render(node, () => html`...`)\n// non keyed renders in the wild via html`...`\nexport const html = outer('html');\nexport const svg = outer('svg');\n\n// - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\nfunction appendClean(node, fragment) {\n  node.textContent = '';\n  node.appendChild(fragment);\n}\n\nfunction asNode(result, forceFragment) {\n  return result.nodeType === wireType ?\n    result.valueOf(forceFragment) :\n    result;\n}\n\nfunction createHook(useRef, view) {\n  return function () {\n    const ref = useRef(null);\n    if (ref.current === null)\n      ref.current = view.for(ref);\n    return asNode(ref.current.apply(null, arguments), false);\n  };\n}\n\nfunction outer(type) {\n  const wm = new WeakMap;\n  tag.for = (identity, id) => {\n    const ref = wm.get(identity) || set(identity);\n    if (id == null)\n      id = '$';\n    return ref[id] || create(ref, id);\n  };\n  return tag;\n  function create(ref, id) {\n    let wire = null;\n    const $ = new Tagger(type);\n    return (ref[id] = function () {\n      const result = $.apply(null, tta.apply(null, arguments));\n      return wire || (wire = wiredContent(result));\n    });\n  }\n  function set(identity) {\n    const ref = {'$': null};\n    wm.set(identity, ref);\n    return ref;\n  }\n  function tag() {\n    const args = tta.apply(null, arguments);\n    return current ?\n      new Hole(type, args) :\n      new Tagger(type).apply(null, args);\n  }\n}\n\nfunction set(node) {\n  const info = {\n    i: 0, length: 0,\n    stack: [],\n    update: false\n  };\n  wm.set(node, info);\n  return info;\n}\n\nfunction update(reference, callback) {\n  const prev = current;\n  current = wm.get(reference) || set(reference);\n  current.i = 0;\n  const ret = callback.call(this);\n  let value;\n  if (ret instanceof Hole) {\n    value = asNode(unroll(ret, 0), current.update);\n    const {i, length, stack, update} = current;\n    if (i < length)\n      stack.splice(current.length = i);\n    if (update)\n      current.update = false;\n  } else {\n    value = asNode(ret, false);\n  }\n  current = prev;\n  return value;\n}\n\nfunction unroll(hole, level) {\n  const {i, length, stack} = current;\n  const {type, args} = hole;\n  const stacked = i < length;\n  current.i++;\n  if (!stacked)\n    current.length = stack.push({\n      l: level,\n      kind: type,\n      tag: null,\n      tpl: args[0],\n      wire: null\n    });\n  unrollArray(args, 1, level + 1);\n  const info = stack[i];\n  if (stacked) {\n    const {l:control, kind, tag, tpl, wire} = info;\n    if (control === level && type === kind && tpl === args[0]) {\n      tag.apply(null, args);\n      return wire;\n    }\n  }\n  const tag = new Tagger(type);\n  const wire = wiredContent(tag.apply(null, args));\n  info.l = level;\n  info.kind = type;\n  info.tag = tag;\n  info.tpl = args[0];\n  info.wire = wire;\n  if (i < 1)\n    current.update = true;\n  return wire;\n}\n\nfunction unrollArray(arr, i, level) {\n  for (const {length} = arr; i < length; i++) {\n    const value = arr[i];\n    if (typeof value === 'object' && value) {\n      if (value instanceof Hole) {\n        arr[i] = unroll(value, level - 1);\n      } else if (isArray(value)) {\n        arr[i] = unrollArray(value, 0, level++);\n      }\n    }\n  }\n  return arr;\n}\n\nfunction wiredContent(node) {\n  const childNodes = node.childNodes;\n  const {length} = childNodes;\n  return length === 1 ?\n    childNodes[0] :\n    (length ? new Wire(childNodes) : node);\n}\n\nfunction Hole(type, args) {\n  this.type = type;\n  this.args = args;\n}\n","import wickedElements from 'wicked-elements'\nimport { html } from 'lighterhtml'\n\nfunction markerMenu (element) {\n  return html`<details class=\"MenuButton MenuButton--marker\">\n  <summary class=\"MenuButton-summary\" aria-label=\"Add marker to sidebar\"><svg viewBox=\"0 0 10 10\" fill=\"currentColor\" stroke=\"transparent\" width=\"15\" height=\"15\">\n  <path d=\"m1 4h8v2h-8zm3-3h2v8h-2z\"></path>\n</svg></summary>\n<marker-menu class=\"MenuButton-body MenuButton-body--right MarkerMenu\">\n  <dl>\n    <dt>Markers</dt>\n  <dd>\n    <ol>\n    <li>${button('', 'agree')}</li>\n    <li>${button('x', 'disagree')}</li>\n    <li>${button('~', 'interesting')}</li>\n    <li>${button('*', 'important')}</li>\n    </ol>\n  </dd>\n    <dt>Hands</dt>\n  <dd>\n    <ol>\n    <li>${button('', 'thumbs up')}</li>\n    <li>${button('', 'thumbs down')}</li>\n    <li>${button('', 'open hand')}</li>\n    <li>${button('', 'clapping')}</li>\n    </ol>\n  </dd>\n  <dt>Smileys</dt>\n  <dd>\n    <ol>\n    <li>${button('', 'slightly smiling face')}</li>\n    <li>${button('', 'face with raised eyebrows')}</li>\n    <li>${button('', 'smiling face with heart-shaped eyes')}</li>\n    <li>${button('', 'face screaming in fear')}</li>\n    <li>${button('', 'neutral face')}</li>\n    <li>${button('', 'face with rolling eyes')}</li>\n    </ol>\n  </dd>\n</dl></div>\n  </details>`\n}\n\nconst descriptions = {\n  '': 'agree',\n  x: 'disagree',\n  '~': 'interesting',\n  '*': 'important',\n  '': 'thumbs up',\n  '': 'thumbs down',\n  '': 'open hand',\n  '': 'clapping',\n  '': 'slightly smiling face',\n  '': 'face with raised eyebrows',\n  '': 'smiling face with heart-shaped eyes',\n  '': 'face screaming in fear',\n  '': 'neutral face',\n  '': 'face with rolling eyes'\n}\n\nfunction renderMarkers (element) {\n  return marker => {\n    const description = descriptions[marker]\n    const label = `Remove '${description}' sidebar marker`\n    return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"marker-button\" data-description=\"${description}\">${marker}</button>`\n  }\n}\n\nfunction button (character, description) {\n  const label = `Add '${description}' sidebar marker`\n  return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"add-marker-button\" data-description=\"${description}\">${character}</button>`\n}\n\nwickedElements.define('[is=\"add-marker-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const newMarker = marker(this.el)\n    const parent = this.el.closest('.Marker')\n    const reference = parent.querySelector('.MenuButton')\n    const description = this.el.dataset.description\n    const existing = parent.querySelector(\n      `[is=\"marker-button\"][data-description=\"${description}\"]`\n    )\n    if (existing) {\n      parent.removeChild(existing)\n    } else {\n      parent.insertBefore(newMarker, reference)\n    }\n    parent.querySelector('details').open = false\n  },\n  ondisconnected (event) {\n    this.el.removeEventListener('click', this)\n  }\n})\n\nfunction marker (element) {\n  const description = element.dataset.description\n  const character = element.textContent\n  const label = `Remove '${description}' sidebar marker`\n  return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"marker-button\" data-description=\"${description}\">${character}</button>`\n}\n\nwickedElements.define('[is=\"marker-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const parent = this.el.parentElement\n    parent.removeChild(this.el)\n  },\n  ondisconnected (event) {\n    this.el.removeEventListener('click', this)\n  }\n})\n\nexport { markerMenu }\n","import wickedElements from 'wicked-elements'\nimport { html } from 'lighterhtml'\nimport { markerMenu } from './marker-menu.js'\n\nconst xpathObserver = new window.IntersectionObserver(onIntersection, {\n  rootMargin: '50px 0px'\n})\nconst positionObserver = new window.IntersectionObserver(onPosition, {\n  threshold: 1,\n  rootMargin: '0px 0px -50% 0px'\n})\nconst noteObserver = new window.IntersectionObserver(onNoteAppear, {\n  rootMargin: '50px 0px'\n})\n\nfunction onNoteAppear (entries) {\n  entries.forEach(entry => {\n    if (entry.intersectionRatio > 0) {\n      noteObserver.unobserve(entry.target)\n      const newNote = entry.target.cloneNode(true)\n      newNote.querySelector('.ql-container').innerHTML = newNote.querySelector(\n        '.ql-editor'\n      ).innerHTML\n      newNote.dataset.component = 'reader-note'\n      entry.target.parentElement.replaceChild(newNote, entry.target)\n    }\n  })\n}\n\nwickedElements.define('.ReaderNote--preRendered', {\n  init: function (event) {\n    noteObserver.observe(event.currentTarget)\n  },\n  onconnected (event) {\n    // // add position attributes to marker\n  },\n  ondisconnected (event) {\n    // remove drop down marker element from sidebar\n  }\n})\n\nlet highest\nfunction onPosition (entries) {\n  const nextHighest = entries.reduce((prev, current) => {\n    if (\n      current.intersectionRatio > prev.intersectionRatio &&\n      current.intersectionRatio === 1\n    ) {\n      return current\n    } else {\n      return prev\n    }\n  })\n  if (!highest) {\n    highest = nextHighest\n  } else if (nextHighest.intersectionRatio >= highest.intersectionRatio) {\n    highest = nextHighest\n  }\n  document.getElementById('chapter').dataset.currentPosition =\n    highest.target.dataset.xpath\n}\n\nfunction onIntersection (entries) {\n  entries.forEach(entry => {\n    if (entry.intersectionRatio > 0) {\n      xpathObserver.unobserve(entry.target)\n      addAnnotationTools(entry.target)\n    }\n  })\n}\n\nfunction addAnnotationTools (element) {\n  const xpath = element.dataset.xpath\n  // const formId = 'marker-' + xpath\n  // const checkId = 'marker-check-' + xpath\n  if (!element.querySelector('.NoteButton')) {\n    const button = html`<button class=\"Button Button--marker NoteButton\" data-component=\"note-button\" aria-label=\"Add note\" data-for=\"${xpath}\"><svg viewBox=\"0 0 10 10\" fill=\"currentColor\" stroke=\"transparent\" width=\"15\" height=\"15\">\n    <path d=\"m1 4h8v2h-8zm3-3h2v8h-2z\"></path>\n  </svg></button>`\n    element.appendChild(button)\n  }\n  const menuContainer = element.querySelector('.Marker')\n  if (menuContainer) {\n    const menu = markerMenu(element)\n    menuContainer.appendChild(menu)\n  }\n}\n\nwickedElements.define('[data-xpath]', {\n  init: function (event) {\n    xpathObserver.observe(event.currentTarget)\n    positionObserver.observe(event.currentTarget)\n  },\n  onconnected (event) {\n    // // add position attributes to marker\n  },\n  ondisconnected (event) {\n    // remove drop down marker element from sidebar\n  }\n})\n","import wickedElements from 'wicked-elements'\nimport {saveXpathNote, updateXpathNote} from './save-note-event.js'\n\nwickedElements.define('[data-component=\"note-button\"]', {\n  init (event) {\n    this.element = event.currentTarget.closest('[data-xpath]')\n    event.currentTarget.addEventListener('click', this)\n    event.currentTarget.dataset.reader = true\n  },\n  onclick (event) {\n    const { element } = this\n    const noteElement = document.getElementById(makeNoteId(element))\n    if (noteElement) {\n      noteElement.querySelector('.ql-editor').focus()\n    } else {\n      const newNote = note(element)\n      element.parentElement.insertBefore(newNote, element.nextSibling)\n      window.requestAnimationFrame(function () {\n        newNote.querySelector('.ql-editor').focus()\n      })\n    }\n  }\n})\n\nwickedElements.define('[data-component=\"reader-note\"]', {\n  init (event) {\n    const element = (this.el = event.currentTarget)\n    const container = this.el.querySelector('.ReaderNote-textarea')\n    this.quill = new window.Quill(container, {\n      modules: {\n        toolbar: [\n          ['bold', 'italic', 'underline'],\n          ['image', 'code-block'],\n          ['link', 'blockquote'],\n          [{ list: 'ordered' }, { list: 'bullet' }],\n          ['clean']\n        ]\n      },\n      theme: 'snow'\n    })\n    this.toolbar = this.el.querySelector('.ql-toolbar')\n    const onFocus = this.onfocus\n    const onBlur = this.onblur\n    this.el.classList.remove('ReaderNote--preRendered')\n    this.quill.on('selection-change', function (range, oldRange, source) {\n      if (range) {\n        onFocus(element)\n      } else {\n        onBlur(element)\n      }\n    })\n    this.quill.on('text-change', function () {\n      element.classList.add('ReaderNote--hasContent')\n      element.dataset.saved = 'false'\n    })\n    const button = document.createElement('button')\n    button.textContent = 'Delete'\n    button.classList.add('TextButton')\n    button.classList.add('TextButton--noteDelete')\n    button.addEventListener('click', event => {\n      this.el.parentElement.removeChild(this.el)\n    })\n    button.dataset.noteDelete = 'true'\n    this.el.appendChild(button)\n  },\n  onfocus (element) {\n    element.classList.add('ReaderNote--hasFocus')\n  },\n  onblur (element) {\n    element.classList.remove('ReaderNote--hasFocus')\n    if (element.dataset.actId) {\n      updateXpathNote(element.querySelector('.ql-editor').innerHTML, element.dataset.for, element.dataset.actId)\n    } else {\n      saveXpathNote(element.querySelector('.ql-editor').innerHTML, element.dataset.for)\n    }\n    element.dataset.saved = 'true'\n  }\n})\n\nfunction note (element) {\n  const xpath = element.dataset.xpath\n  const form = document.createElement('form')\n  form.dataset.component = 'reader-note'\n  form.dataset.for = xpath\n  form.dataset.reader = 'true'\n  form.classList.add('ReaderNote')\n  form.id = 'ReaderNote-' + xpath\n  const textareaId = 'ReaderNote-text-' + xpath\n  form.dataset.newNote = 'true'\n  form.innerHTML = `<div class=\"ReaderNote-textarea\" id=\"${textareaId}\" data-reader=\"true\" aria-label=\"Sidebar note\"></div>`\n  const button = document.createElement('button')\n  button.textContent = 'Cancel'\n  button.classList.add('TextButton')\n  button.classList.add('TextButton--noteButton')\n  button.addEventListener('click', event => {\n    form.parentElement.removeChild(form)\n  })\n  button.dataset.noteCancel = 'true'\n  form.appendChild(button)\n  return form\n}\n\nfunction makeNoteId (element) {\n  return 'ReaderNote-' + element.dataset.xpath\n}\n"],"names":["$Event","Event","o_O","CustomEvent","type","e","document","createEvent","initEvent","$WeakSet","WeakSet","constructor","WeakMap","this","$","prototype","add","O","set","has","delete","i","Math","random","join","Object","defineProperty","value","configurable","hasOwnProperty","call","assign","target","o","arguments","length","k","contains","el","parentNode","indexOf","matches","documentElement","selector","matchesSelector","webkitMatchesSelector","khtmlMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","querySelectorAll","bootstrap","query","config","waiting","known","regularElements","define","options","doc","MutationObserver","changes","observe","subtree","childList","addEventListener","addedNodes","readyState","ready","once","init","Error","push","nodeType","setupListeners","get","whenDefined","Promise","resolve","lifecycle","poly","CONNECTED","DISCONNECTED","notObserving","observer","node","dispatched","timer","records","reschedule","record","clearTimeout","setTimeout","splice","event","removedNodes","Tracker","dispatchAll","nodes","counter","dispatchTarget","dispatchEvent","children","startObserving","ownerDocument","disconnected","attributechanged","attributeFilter","attributes","attributeOldValue","filtered","Array","slice","handleEvent","attrModified","attrName","prevValue","attributeName","oldValue","newValue","getAttribute","connected","setupList","setup","ws","css","isElement","setupListener","dispatch","method","create","wickedElements","component","definition","onconnected","currentTarget","removeEventListener","handler","invoke","key","addIfNeeded","filter","out","noop","tagName","n","arr","ele","start","len","exports","iter","where","whatToShow","SHOW_TEXT","E_SHOW","count","referenceNode","predicates","isNaN","parseInt","isFinite","forward","backward","TEXT_NODE","isText","E_WHERE","ref","common","left","concat","_ancestors2","reverse","right","shift","l","_indexOf2","childNodes","r","before","pointerBeforeReferenceNode","nextNode","nodeValue","previousNode","_interopRequireDefault","_ancestors","_indexOf","obj","__esModule","default","require$$0","rangeId","highlightString","text","offset","body","textContent","iterator","createNodeIterator","window","NodeFilter","split","seek","splitText","end","nodeCollector","parentElement","closest","highlight","createElement","dataset","classList","replaceChild","appendChild","[object Object]","element","selected","forEach","detail","remove","disabled","range","createRange","setStartBefore","firstChild","setEndAfter","lastChild","fragment","extractContents","onreader:highlight-selected","console","log","onreader:highlight-deselected","selection","getSelection","isCollapsed","rangeCount","endRange","getRangeAt","setEnd","endContainer","endOffset","startContainer","ranges","getElementById","SHOW_ALL","newRange","setStart","startOffset","setEndBefore","undefined","getRanges","html","placeholder","cloneContents","removeChild","replaceWith","innerHTML","serializeRange","texts","map","toString","startXpath","endXpath","rangeString","note","startElement","endElement","payload","oa:hasSelector","content","object","saveQuoteNote","xpath","collapseToStart","parent","container","querySelector","quill","Quill","modules","toolbar","list","theme","onFocus","onfocus","onBlur","onblur","on","oldRange","source","button","noteDelete","name","running","requestAnimationFrame","throttle","setSize","size","offsetWidth","style","setProperty","self","id","dP","hOP","proto","_","iterable","pair","templateLiteral","isNoOp","tl","propertyIsEnumerable","isFrozen","test","defaultView","navigator","userAgent","parseFloat","RegExp","$1","forever","TL","template","args","unique","Wire","ELEMENT_NODE","keepFirst","first","last","deleteContents","valueOf","forceAppend","noFragment","createDocumentFragment","isArray","wireType","createContent","FRAGMENT","createHTML","append","markup","svg","root","createElementNS","Map","v","had","insertBefore","eqeq","a","b","identity","moreNodes","moreStart","moreEnd","lessNodes","lessStart","lessEnd","compare","m","next","nextSibling","findK","ktr","j","lo","hi","mid","smartDiff","futureNodes","futureStart","futureEnd","futureChanges","currentNodes","currentStart","currentEnd","currentChanges","currentLength","diff","live","currentIndex","applyDiff","rows","cols","d","c","pv","cv","pd","outer","diffIdx","OND","minLen","link","tresh","keymap","idxInOld","newi","oldi","prev","ptr","HS","domdiff","currentSame","futureSame","isReversed","importNode","cloneNode","createTextNode","native","deep","clone","trim","String","replace","UID","toFixed","UIDC","COMMENT_NODE","SHOULD_USE_TEXT_CONTENT","VOID_ELEMENTS","spaces","attrPartials","attrSeeker","selfClosing","findAttributes","attrReplacer","$0","$2","$3","replaceAttributes","fullClosing","path","find","parseAttributes","holes","parts","cache","array","attribute","realName","toLowerCase","attr","removeAttribute","removeAttributeNode","nodeName","script","setAttributeNode","parsed","referenced","createInfo","sanitize","transform","child","cleanContent","parse","childPath","info","updates","callbacks","any","values","domtagger","details","createDetails","apply","hyperStyle","IS_NON_DIMENSIONAL","hyphen","original","setAttribute","getAttributeNode","update","ized","isSVG","oldType","styleValue","cssText","toStyle","asNode","item","hyperProperty","readOnly","Tagger","callback","current","hyperRef","hyperEvent","owner","hyperAttribute","diffOptions","fastPath","anyContent","canDiff","wm","tag","for","wire","result","tta","wiredContent","Hole","character","description","newMarker","marker","reference","existing","open","xpathObserver","IntersectionObserver","entries","entry","intersectionRatio","unobserve","menuContainer","menu","addAnnotationTools","rootMargin","positionObserver","nextHighest","reduce","highest","currentPosition","threshold","noteObserver","newNote","reader","noteElement","makeNoteId","focus","form","textareaId","noteCancel","saved","actId","updateXpathNote","saveXpathNote"],"mappings":"AAkBA,IAAIA,EAEJ,IACE,IAAIC,MAAM,KACVD,EAASC,MACT,MAAMC,GACN,IACE,IAAIC,YAAY,KAChBH,EAASG,YACT,MAAMD,GACNF,EAAS,SAAUI,GACjB,IAAIC,EAAIC,SAASC,YAAY,SAE7B,OADAF,EAAEG,UAAUJ,GAAM,GAAO,GAClBC,IAKb,IClBII,IDkBWT,EChBf,IACES,GAAW,IAAKC,SAASC,YACzB,MAAMT,GACN,KAEEA,GAAOO,EAAW,IAAIG,SAAW,WAC/BC,KAAKC,EAAI,IAAIF,UACZG,WACCC,IAAM,SAAUC,GAElB,OADAJ,KAAKC,EAAEI,IAAID,EAAG,GACPJ,MAETX,EAAIiB,IAAM,SAAUF,GAClB,OAAOJ,KAAKC,EAAEK,IAAIF,IAEpBf,EAAIkB,OAAS,SAAUH,GACrB,OAAOJ,KAAKC,EAAEM,OAAOH,IAEvB,MAAMf,GAEN,IAAImB,EAAI,GACRnB,GAAOO,EAAW,WAChBI,KAAKC,EAAI,CAAC,KAAMQ,KAAKC,SAAUF,IAAK,MAAMG,KAAK,QAC9CT,WACCC,IAAM,SAAUC,GAGlB,OAFKJ,KAAKM,IAAIF,IACZQ,OAAOC,eAAeT,EAAGJ,KAAKC,EAAG,CAACa,OAAM,EAAMC,cAAa,IACtDf,MAETX,EAAIiB,IAAM,SAAUF,GAClB,OAAOJ,KAAKgB,eAAeC,KAAKb,EAAGJ,KAAKC,IAE1CZ,EAAIkB,OAAS,SAAUH,GACrB,cAAcA,EAAEJ,KAAKC,KAK3B,MAAeL,ICxCAgB,OAAOM,QAAU,SAAUC,GACxC,IAAK,IAAIC,EAAGZ,EAAI,EAAGA,EAAIa,UAAUC,OAAQd,IAEvC,IAAK,IAAIe,KADTH,EAAIC,UAAUb,IAAM,GAEdY,EAAEJ,eAAeO,KACnBJ,EAAOI,GAAKH,EAAEG,IAGpB,OAAOJ,GCzBLK,EAAW/B,SAAS+B,UAAY,SAAUC,GAC5C,KAAOA,GAAMA,IAAOzB,MAAMyB,EAAKA,EAAGC,WAClC,OAAO1B,OAASyB,GCHdE,EAAU,GAAGA,QAGbC,EAAU,YAAanC,SAASoC,gBAClC,SAAUJ,EAAIK,GACZ,OAAOL,EAAGG,QAAQE,IAEpB,SAAUL,EAAIK,GACZ,OACEL,EAAGM,iBACHN,EAAGO,uBACHP,EAAGQ,sBACHR,EAAGS,oBACHT,EAAGU,mBACHV,EAAGW,kBAOT,SAAkBN,GAChB,IAAIJ,EAAa1B,KAAK0B,WACtB,QAASA,IAAe,EAAIC,EAAQV,KAClCS,EAAWW,iBAAiBP,GAC5B9B,QATEiB,KAAKQ,EAAIK,ICYf,IAAIQ,GAAY,EAEZC,EAAQ,GACRC,EAAS,GACTC,EAAU,GACVC,EAAQ,GAERC,EAAkB,CACpBvD,MAAOA,EACPS,QAASA,EACTqB,OAAQA,EACRzB,SAAUA,SACVmD,OAAQ,SAAUd,EAAUe,GACtBP,IACFA,GAAY,EAkDlB,SAAcQ,GACZ,IACE,IAAKC,iBAAiBC,GACnBC,QAAQH,EAAK,CAACI,SAAS,EAAMC,WAAW,IAE7C,MAAM9D,GACJyD,EAAIM,iBACF,kBACA,SAAU5D,GACRwD,EAAQ,CAAC,CAACK,WAAY,CAAC7D,EAAE2B,aAE3B,GAGmB,aAAnB2B,EAAIQ,YACNR,EAAIM,iBAAiB,mBAAoBG,EAAO,CAACC,MAAM,IAhErDC,CAAKd,EAAgBlD,WAEvB,IAAIF,SAAcuC,EAClB,GAAa,WAATvC,EAAmB,CACrB,IAAK,EAAIgD,EAAMZ,QAAQG,GACrB,MAAM,IAAI4B,MAAM,eAAiB5B,GACnCS,EAAMoB,KAAK7B,GACXU,EAAOmB,KAAKd,GAAW,IACvBU,IACIzB,KAAYW,IACdA,EAAQX,GAAUU,EAAOA,EAAOlB,OAAS,WAClCmB,EAAQX,QAEZ,CACL,GAAa,WAATvC,GAA2C,IAAtBuC,EAAS8B,SAChC,MAAM,IAAIF,MAAM,gBAAkB5B,GACpC+B,EAAe/B,EAAUe,GAAW,MAGxCiB,IAAK,SAAUhC,GACb,IAAItB,EAAI+B,EAAMZ,QAAQG,GACtB,OAAOtB,EAAI,EAAI,KAAOU,EAAO,GAAIsB,EAAOhC,KAE1CuD,YAAa,SAAUjC,GACrB,OAAOkC,QAAQC,QACbtB,EAAgBmB,IAAIhC,IACpB,IAAIkC,QAAQ,SAAU/D,GACpBwC,EAAQX,GAAY7B,OAOxBiE,EC5EJ,SAAsBC,GACpB,IAAIC,EAAY,YACZC,EAAe,MAAQD,EACvBhF,EAAQ+E,EAAK/E,MACbS,EAAUsE,EAAKtE,QACfyE,GAAe,EACfC,EAAW,IAAI1E,EACnB,OAAO,SAAiB2E,GAMtB,OALIF,IACFA,GAAgBA,EAMpB,SAAwB7E,GACtB,IAAIgF,EAAa,KACjB,IACE,IAAK1B,iBAAiBC,GAAUC,QAC9BxD,EACA,CAACyD,SAAS,EAAMC,WAAW,IAG/B,MAAM9D,GACJ,IAAIqF,EAAQ,EACRC,EAAU,GACVC,EAAa,SAAUC,GACzBF,EAAQhB,KAAKkB,GACbC,aAAaJ,GACbA,EAAQK,WACN,WACE/B,EAAQ2B,EAAQK,OAAON,EAAQ,EAAGC,EAAQrD,UAE5C,IAGJ7B,EAAS2D,iBACP,iBACA,SAAU6B,GACRL,EAAW,CAACvB,WAAY,GAAI6B,aAAc,CAACD,EAAM9D,YAEnD,GAEF1B,EAAS2D,iBACP,kBACA,SAAU6B,GACRL,EAAW,CAACvB,WAAY,CAAC4B,EAAM9D,QAAS+D,aAAc,OAExD,GAGJ,SAASlC,EAAQ2B,GACfF,EAAa,IAAIU,EACjB,IAAK,IACHN,EACAvD,EAASqD,EAAQrD,OACjBd,EAAI,EAAGA,EAAIc,EAAQd,IAGnB4E,GADAP,EAASF,EAAQnE,IACE0E,aAAcb,EAAcD,GAC/CgB,EAAYP,EAAOxB,WAAYe,EAAWC,GAE5CI,EAAa,KAEf,SAASW,EAAYC,EAAO9F,EAAM+F,GAChC,IAAK,IACHd,EACAS,EAAQ,IAAI7F,EAAMG,GAClB+B,EAAS+D,EAAM/D,OACfd,EAAI,EAAGA,EAAIc,EACsB,KAAhCkD,EAAOa,EAAM7E,MAAMoD,UACpB2B,EAAef,EAAMS,EAAO1F,EAAM+F,KAGtC,SAASC,EAAef,EAAMS,EAAO1F,EAAM+F,GACrCf,EAASjE,IAAIkE,KAAUC,EAAWlF,GAAMe,IAAIkE,KAC9CC,EAAWa,GAAS/E,OAAOiE,GAC3BC,EAAWlF,GAAMY,IAAIqE,GACrBA,EAAKgB,cAAcP,IAerB,IAAK,IACHQ,EAAWjB,EAAKiB,SAChBnE,EAASmE,EAASnE,OAClBd,EAAI,EAAGA,EAAIc,EACXiE,EAAeE,EAASjF,KAAMyE,EAAO1F,EAAM+F,KAG/C,SAASH,IACPnF,KAAKoE,GAAa,IAAIvE,EACtBG,KAAKqE,GAAgB,IAAIxE,GA5FzB6F,CAAelB,EAAKmB,gBAEtBpB,EAASpE,IAAIqE,GACNA,GD+DKoB,CAAajD,GACzBM,EAAU,CACZ4C,iBE9EF,SAA0B1B,GACxB,IAAI/E,EAAQ+E,EAAK/E,MACjB,OAAO,SAAiBoF,EAAMsB,GAC5B,IAAIjD,EAAU,CAACkD,YAAY,EAAMC,mBAAmB,GAChDC,EAAWH,aAA2BI,OAASJ,EAAgBxE,OAC/D2E,IACFpD,EAAQiD,gBAAkBA,EAAgBK,MAAM,IAClD,IACE,IAAKpD,iBAAiBC,GAAUC,QAAQuB,EAAM3B,GAC9C,MAAMxD,GACNwD,EAAQuD,YAAcH,EAAWG,EAAcC,EAC/C7B,EAAKpB,iBAAiB,kBAAmBP,GAAS,GAEpD,OAAO2B,GAET,SAAS6B,EAAapB,GACpBO,EAAcP,EAAM9D,OAAQ8D,EAAMqB,SAAUrB,EAAMsB,WAEpD,SAASf,EAAchB,EAAMgC,EAAeC,GAC1C,IAAIxB,EAAQ,IAAI7F,EAAM,oBACtB6F,EAAMuB,cAAgBA,EACtBvB,EAAMwB,SAAWA,EACjBxB,EAAMyB,SAAWlC,EAAKmC,aAAaH,GACnChC,EAAKgB,cAAcP,GAErB,SAASjC,EAAQ2B,GACf,IAAK,IAAIE,EAAQrE,EAAI,EAAGc,EAASqD,EAAQrD,OAAQd,EAAIc,EAAQd,IAE3DgF,GADAX,EAASF,EAAQnE,IACIW,OAAQ0D,EAAO2B,cAAe3B,EAAO4B,UAG9D,SAASL,EAAYnB,IACd,EAAIjF,KAAK8F,gBAAgBnE,QAAQsD,EAAMqB,WAC1CD,EAAapB,IF6CCY,CAAiBlD,GACnCiE,UAAW1C,EACX0B,aAAc1B,GAMhB,SAASlB,EAAQ2B,GACf,IAAK,IAAInE,EAAI,EAAGc,EAASqD,EAAQrD,OAAQd,EAAIc,EAAQd,IACnDqG,EAAUlC,EAAQnE,GAAG6C,YAAY,GAqBrC,SAASE,IACHhB,EAAMjB,QACRuF,EAAUlE,EAAgBlD,SAAS4C,iBAAiBE,IAAQ,GAGhE,SAASuE,EAAMtC,GACbqC,EAAUrC,EAAKnC,iBAAiBE,IAAQ,GACxC,IAAK,IAAIwE,EAAIC,EAAKxG,EAAI,EAAGc,EAASiB,EAAMjB,OAAQd,EAAIc,EAAQd,IAC1DwG,EAAMzE,EAAM/B,KACZuG,EAAKrE,EAAMsE,KAAStE,EAAMsE,GAAO,IAAInH,IAC7BS,IAAIkE,IAAS5C,EAAQ4C,EAAMjC,EAAM/B,MACvCuG,EAAG5G,IAAIqE,GACPX,EAAeW,EAAMhC,EAAOhC,KAKlC,SAASqG,EAAUxB,EAAO4B,GACxB,IAAK,IAAIzC,EAAMhE,EAAI,EAAGc,EAAS+D,EAAM/D,OAAQd,EAAIc,EAAQd,IACvDgE,EAAOa,EAAM7E,IACTyG,GAA+B,IAAlBzC,EAAKZ,WACpBkD,EAAMtC,GAIZ,SAAS0C,EAAc1C,EAAM3B,EAAStD,EAAM4H,GAC1C,IAAIC,EAASvE,EAAQ,KAAOtD,GACxB6H,IACFnE,EAAQ1D,GAAMiF,EAAM3B,EAAQiD,iBACzB1C,iBAAiB7D,EAAM6H,GAAQ,GAC9BD,GAAY3F,EAASP,KAAK0B,EAAgBlD,SAAU+E,IACtDA,EAAKgB,cAAc,IAAIpG,EAAMG,KAInC,SAASsE,EAAeW,EAAM3B,GAC5BqE,EAAc1C,EAAM3B,EAAS,oBAAoB,GACjDqE,EAAc1C,EAAM3B,EAAS,gBAAgB,GAC7CqE,EAAc1C,EAAM3B,EAAS,aAAa,GG/H5C,IAKIwE,EAASzG,OAAOyG,OAQhBC,EAAiBD,EAAO1E,EAAiB,CAC3CC,OAAQ,CACN9B,MAAO,SAAUgB,EAAUyF,GACzB,IAAIR,EAAK,IAAIlH,EACT2H,EAAa,CAACC,YAAaX,GAU/B,SAASA,EAAM7B,GACb,IAAIxD,EAAKwD,EAAMyC,cACXnI,EAAO0F,EAAM1F,KACjBkC,EAAGkG,oBAAoBpI,EAAMuH,GACxBC,EAAGzG,IAAImB,KACVsF,EAAG5G,IAAIsB,GAejB,SAAmB8F,EAAWtC,EAAOxD,EAAI2F,GACvC,IAAIQ,EAAUP,EAAOE,GACjBM,GAAS,EACb,IAAK,IAAIC,KAAOP,EACU,OAApBO,EAAI3B,MAAM,EAAG,KACf1E,EAAG2B,iBAAiB0E,EAAI3B,MAAM,GAAIyB,GAAS,GACvCE,IAAQV,IACVS,GAAUA,IAGhBD,EAAQnE,KAAKwB,GACT4C,GACFD,EAAQxB,YAAYnB,GA1Bd3C,CAAUiF,EAAWtC,EAAOxD,EAAI,KAAOlC,IAhC5B,mBAiBOgI,IACpBC,EAAyB,eAAIV,GAjBZ,uBAkBOS,IACxBC,EAA6B,mBAAIV,EACjCU,EAA2B,gBAAID,EAA0B,iBAAK,IAEhEQ,EAAYR,EAAW,OAAQ9D,GAC/BsE,EAAYR,EAAW,cAAenB,GACtCzD,EAAgBC,OAAOd,EAAU0F,OAgBvC,SAASO,EAAYR,EAAWO,EAAKhH,GAC7BgH,KAAOP,IACXA,EAAUO,GAAOhH,GAkBrB,SAASsF,EAAYnB,GACnB,IAAI1F,EAAO,KAAO0F,EAAM1F,KACpBA,KAAQS,MACVA,KAAKT,GAAM0F,GAGf,SAASxB,EAAKwB,GACZjF,KAAKyB,GAAKwD,EAAMyC,cC1FlB,MAEA,SAAiBlD,EAAMwD,GACrB,IAAIC,EAAM,GAEVD,EAASA,GAAUE,EAEnB,GACED,EAAItE,KAAKa,GACTA,EAAOA,EAAK9C,iBACN8C,GAAQA,EAAK2D,SAAWH,EAAOxD,IAEvC,OAAOyD,EAAI9B,MAAM,IAGnB,SAAS+B,EAAKE,GACZ,OAAO,ECPT,UAAiB,SAAiBC,EAAKC,EAAKC,GAC1CA,EAAQA,GAAS,EAGjB,GAAW,MAAPF,EAAa,OAFN,EAGX,IAAIG,EAAMH,EAAI/G,OACVd,EAAI+H,EAAQ,EACXC,EAAMD,EACPA,EAEJ,GAAI/H,GAAK6H,EAAI/G,OACX,OAAQ,EAGV,KAAOd,EAAIgI,GAAK,CACd,GAAIH,EAAI7H,KAAO8H,EACb,OAAO9H,EAETA,IAGF,OAAQ,oBC5BViI,cAAqB,EACrBA,EAAiB,QAkBjB,SAAcC,EAAMC,GAClB,GAAID,EAAKE,aAAeC,EACtB,MAAM,IAAInF,MAAMoF,GAGlB,IAAIC,EAAQ,EACRvE,EAAOkE,EAAKM,cACZC,EAAa,KAEjB,GAkCgBb,EAlCHO,GAmCLO,MAAMC,SAASf,KAAOgB,SAAShB,GAlCrCa,EAAa,CACXI,QAAS,WACP,OAAON,EAAQJ,GAEjBW,SAAU,WACR,OAAOP,EAAQJ,QAGd,CAAA,IA6BT,SAAgBnE,GACd,OAAOA,EAAKZ,WAAa2F,EA9BdC,CAAOb,GAWhB,MAAM,IAAIjF,MAAM+F,GAVhB,IAAIJ,EAgCR,SAAgBK,EAAKlF,GACnB,GAAIkF,IAAQlF,EAAM,OAAO,EAEzB,IAAImF,EAAS,KACTC,EAAO,CAACF,GAAKG,QAAO,EAAIC,EAAqB,SAAGJ,IAAMK,UACtDC,EAAQ,CAACxF,GAAMqF,QAAO,EAAIC,EAAqB,SAAGtF,IAAOuF,UAE7D,KAAOH,EAAK,KAAOI,EAAM,IACvBL,EAASC,EAAKK,QACdD,EAAMC,QAGRL,EAAOA,EAAK,GACZI,EAAQA,EAAM,GAEd,IAAIE,GAAI,EAAIC,EAAmB,SAAGR,EAAOS,WAAYR,GACjDS,GAAI,EAAIF,EAAmB,SAAGR,EAAOS,WAAYJ,GAErD,OAAOE,EAAIG,EAlDKC,CAAO9F,EAAMmE,GAAS,WAClC,OAAO,GACL,WACF,OAAOnE,IAASmE,GAKlBM,EAAa,CAAEI,QAASA,EAASC,SAHlB,WACb,OAAO9E,GAAQmE,IAAUD,EAAK6B,6BAkBpC,IAAkBnC,EAXhB,KAAOa,EAAWI,WAA0C,QAA5B7E,EAAOkE,EAAK8B,aAC1CzB,GAASvE,EAAKiG,UAAUnJ,OAG1B,KAAO2H,EAAWK,YAA+C,QAAhC9E,EAAOkE,EAAKgC,iBAC3C3B,GAASvE,EAAKiG,UAAUnJ,OAG1B,OAAOyH,GAtDT,IAAIe,EAAca,EAAuBC,GAIrCT,EAAYQ,EAAuBE,GAEvC,SAASF,EAAuBG,GAAO,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CAAEE,QAAWF,GAEzF,IAAIhC,EAAS,2DACTW,EAAU,sDAEVZ,EAAY,EACZU,EAAY,0HCnBhB,MAAiB0B,EAA0B,QCG3C,IAAIC,EAAU,EA4Jd,SAASC,EAAiBC,EAAMF,GAC9B,MAAMG,EAAS5L,SAAS6L,KAAKC,YAAY5J,QAAQyJ,GAC3C9J,EAAS8J,EAAK9J,OACdkK,EAAW/L,SAASgM,mBACxBhM,SAAS6L,KACTI,OAAOC,WAAW9C,WAEpB,SAAS+C,EAAOjD,GACd,MAAMI,EAAQ8C,EAAKL,EAAU7C,GAQ7B,OAPII,IAAUJ,IAEZ6C,EAASxC,cAAc8C,UAAUnD,EAAQI,GAGzC8C,EAAKL,EAAU7C,EAAQI,IAElByC,EAASxC,cAElB4C,EAAMP,GACN,MAAMU,EAAMH,EAAMtK,GACZ0K,EAAgBvM,SAASgM,mBAC7BhM,SAAS6L,KACTI,OAAOC,WAAW9C,WAEpBgD,EAAKG,EAAeX,GAEpB,IADA,IAAIhG,EAAQ,GACL2G,EAAchD,gBAAkB+C,GACrC1G,EAAM1B,KAAKqI,EAAcxB,YAG3B,IAAK,IAAIhK,EAAI,EAAGA,EAAI6E,EAAM/D,OAAQd,IAAK,CACrC,MAAMgE,EAAOa,EAAM7E,GACnB,IAAKgE,EAAKyH,cAAcC,QAAQ,mBAAqB1H,EAAKyH,cAAcC,QAAQ,oBAAqB,CAEnG,MAAMC,EAAY1M,SAAS2M,cAAc,oBACzCD,EAAUE,QAAQnB,QAAUA,EAC5BiB,EAAUG,UAAUnM,IAAI,aAGxBqE,EAAK9C,WAAW6K,aAAaJ,EAAW3H,GACxC2H,EAAUK,YAAYhI,KAlM5B8C,EAAe1E,OAAO,mBAAoB,CACxC6J,YAAaxH,GACXjF,KAAK0M,QAAUzH,EAAMyC,cACrB1H,KAAKyB,GAAG2B,iBAAiB,QAASpD,OAEpCyM,QAASxH,GACP,MAAMiG,EAAUlL,KAAK0M,QAAQL,QAAQnB,QAC/ByB,EAAW3M,KAAK0M,QAAQJ,UAAU9K,SAAS,uBAC7C0J,IAAYyB,GACdlN,SACG4C,oCAAoC6I,OACpC0B,QAAQF,GAAWA,EAAQJ,UAAUnM,IAAI,wBAC5CV,SAAS6L,KAAK9F,cACZ,IAAIkG,OAAOpM,YAAY,4BAA6B,CAClDuN,OAAQ,CAAE3B,QAAAA,OAGLyB,IACTlN,SACG4C,oCAAoC6I,OACpC0B,QAAQF,GAAWA,EAAQJ,UAAUQ,OAAO,wBAC/CrN,SAAS6L,KAAK9F,cACZ,IAAIkG,OAAOpM,YAAY,8BAA+B,CACpDuN,OAAQ,CAAE3B,QAAAA,UAOpB5D,EAAe1E,OAAO,iCAAkC,CACtD6J,YAAaxH,GACXjF,KAAK0M,QAAUzH,EAAMyC,cACrB1H,KAAK0M,QAAQtJ,iBAAiB,QAASpD,MACvCP,SAAS6L,KAAKlI,iBAAiB,4BAA6BpD,MAC5DP,SAAS6L,KAAKlI,iBAAiB,8BAA+BpD,MAC9DA,KAAK0M,QAAQK,UAAW,GAE1BN,QAASxH,GACPxF,SACG4C,oDACoCrC,KAAK0M,QAAQL,QAAQnB,aAEzD0B,QAAQF,IACP,MAAMM,EAAQvN,SAASwN,cACvBD,EAAME,eAAeR,EAAQS,YAC7BH,EAAMI,YAAYV,EAAQW,WAC1B,MAAMC,EAAWN,EAAMO,kBACvBb,EAAQT,cAAcM,aAAae,EAAUZ,MAGnDc,8BAA+B,SAAUvI,GACvCwI,QAAQC,IAAIzI,GACZjF,KAAK0M,QAAQK,UAAW,EACxB/M,KAAK0M,QAAQL,QAAQnB,QAAUjG,EAAM4H,OAAO3B,SAE9CyC,gCAAiC,SAAU1I,GACzCwI,QAAQC,IAAIzI,GACZjF,KAAK0M,QAAQK,UAAW,EACxB/M,KAAK0M,QAAQL,QAAQnB,QAAU,QAInC5D,EAAe1E,OAAO,0BAA2B,CAC/C6J,YAAaxH,GACXjF,KAAKyB,GAAKwD,EAAMyC,cAChB1H,KAAKyB,GAAG2B,iBAAiB,QAASpD,OAEpCyM,QAASxH,GACP,MAAM2I,EAAYlC,OAAOmC,eACzB,GAAID,EAAUE,YAAa,OAAO,KAClC,IAAId,EACJ,GAAIY,EAAUG,WAAa,EAAG,CAC5B,MAAMC,EAAWJ,EAAUK,WAAWL,EAAUG,WAAa,IAC7Df,EAAQY,EAAUK,WAAW,IACvBC,OAAOF,EAASG,aAAcH,EAASI,gBAE7CpB,EAAQY,EAAUK,WAAW,GAE/B,GAAIjB,EAAMqB,eAAepC,cAAcC,QAAQ,iBAAoB,OAAO,KAC1E,MAAMoC,EAqCV,SAAoBtB,GAClB,MAAMjB,EAAMiB,EAAMmB,aACZ5F,EAAQyE,EAAMqB,eACd7C,EAAW/L,SAASgM,mBACxBhM,SAAS8O,eAAe,WACxB7C,OAAOC,WAAW6C,UAEpB,KAAOhD,EAASxC,gBAAkBT,GAChCiD,EAAShB,WAEX,MAAM8D,EAAS,GACf,IAAIG,EAAWhP,SAASwN,cACxBwB,EAASC,SAAS1B,EAAMqB,eAAgBrB,EAAM2B,aAC9C,KAAOnD,EAASxC,gBAAkB+C,GAAK,CACrC,MAAMrC,EAAM8B,EAASxC,cACjByF,GAAY/E,EAAI9H,SAAW8H,EAAI9H,QAAQ,kBACzC6M,EAASG,aAAalF,GACtB4E,EAAO3K,KAAK8K,GACZA,OAAWI,EACXrD,EAAShB,YACAd,EAAIuC,cAAcC,QAAQ,iBACnCV,EAAShB,WACCiE,EAKVjD,EAAShB,aAJTiE,EAAWhP,SAASwN,eACXC,eAAexD,GACxB8B,EAAShB,YAKTiE,IACFA,EAASP,OAAOnC,EAAKiB,EAAMoB,WAC3BE,EAAO3K,KAAK8K,IAEd,OAAOH,EAvEUQ,CAAU9B,GACnB+B,EAuBV,SAAyB/B,GACvB,MAAMgC,EAAcvP,SAAS2M,cAAc,OACrCkB,EAAWN,EAAMiC,gBAQvB,OAPA3B,EAASjL,iBAAiB,iBAAiBuK,QAAQF,IACjDA,EAAQT,cAAciD,YAAYxC,KAEpCY,EAASjL,iBAAiB,oBAAoBuK,QAAQF,IACpDA,EAAQyC,YAAYzC,EAAQnB,eAE9ByD,EAAYxC,YAAYc,GACjB0B,EAAYI,UAjCJC,CAAerC,GACtBsC,EAAQhB,EAAOiB,IAAIvC,GAASA,EAAMwC,YAGxC,IAAIC,EAMAC,EARJJ,EAAM1C,QAAQ+C,GAAexE,EAAgBwE,EAAazE,ICnDvD,SAAwB0E,EAAMN,EAAOO,EAAcC,EAAY5E,GAEpE,MAAM6E,EAAU,CACdxQ,KAAM,OACNyQ,iBAAkB,CAChBzQ,KAAM,2BACNsQ,aAAAA,EACAC,WAAAA,EACA5E,QAAAA,EACApK,MAAOwO,GAETW,QAASL,GAEXnC,QAAQC,IAAIqC,GAEZtQ,SAAS6L,KAAK9F,cACZ,IAAIkG,OAAOpM,YAAY,mBAAoB,CACzCuN,OAAQ,CAAEtN,KAAM,SAAU2Q,OAAQH,MDgDpCI,gBAb4BpB,iBAaRO,EAVlBG,EADEzC,EAAMqB,eAAenC,QACVc,EAAMqB,eAAenC,QAAQ,gBAAgBG,QAAQ+D,MAErDpD,EAAMqB,eAAepC,cAAcC,QAAQ,gBAAgBG,QAAQ+D,MAIhFV,EADE1C,EAAMmB,aAAajC,QACVc,EAAMmB,aAAajC,QAAQ,gBAAgBG,QAAQ+D,MAEnDpD,EAAMmB,aAAalC,cAAcC,QAAQ,gBAAgBG,QAAQ+D,MAE7BlF,GAEjD0C,EAAUyC,kBACVnF,GAAoB,KAmGxBQ,OAAOP,gBAAkBA,EE1MzB7D,EAAe1E,OAAO,mBAAoB,CACxC6J,YAAaxH,GACXjF,KAAKyB,GAAKwD,EAAMyC,cAChB1H,KAAKsQ,OAAStQ,KAAKyB,GAAGyK,QAAQ,WAC9BlM,KAAKyB,GAAG2B,iBAAiB,SAAUpD,OAErCyM,SAAUxH,GACRjF,KAAKsQ,OAAOhE,UAAUnM,IAAI,yBAI9BmH,EAAe1E,OAAO,qBAAsB,CAC1C6J,KAAMxH,GACJ,MAAMyH,EAAW1M,KAAKyB,GAAKwD,EAAMyC,cAC3B6I,EAAYvQ,KAAKyB,GAAG+O,cAAc,wBACxCxQ,KAAKyQ,MAAQ,IAAI/E,OAAOgF,MAAMH,EAAW,CACvCI,QAAS,CACPC,QAAS,CACP,CAAC,OAAQ,SAAU,aACnB,CAAC,QAAS,cACV,CAAC,OAAQ,cACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,WAGLC,MAAO,SAET9Q,KAAK4Q,QAAU5Q,KAAKyB,GAAG+O,cAAc,eACrC,MAAMO,EAAU/Q,KAAKgR,QACfC,EAASjR,KAAKkR,OACpBlR,KAAKyQ,MAAMU,GAAG,mBAAoB,SAAUnE,EAAOoE,EAAUC,GACvDrE,EACF+D,EAAQrE,GAERuE,EAAOvE,KAGX1M,KAAKyQ,MAAMU,GAAG,cAAe,WAC3BzE,EAAQT,cAAcK,UAAUnM,IAAI,wBAEtC,MAAMmR,EAAS7R,SAAS2M,cAAc,UACtCkF,EAAO/F,YAAc,SACrB+F,EAAOhF,UAAUnM,IAAI,cACrBmR,EAAOhF,UAAUnM,IAAI,0BACrBmR,EAAOlO,iBAAiB,QAAS6B,IAC/BjF,KAAKyB,GAAGwK,cAAciD,YAAYlP,KAAKyB,MAEzC6P,EAAOjF,QAAQkF,WAAa,OAC5BvR,KAAKyB,GAAG+K,YAAY8E,IAEtB7E,QAASC,GACPA,EAAQJ,UAAUnM,IAAI,yBAExBsM,OAAQC,GACNA,EAAQJ,UAAUQ,OAAO,2BCtD7B,SAAmBvN,EAAMiS,EAAM1G,GAC7BA,EAAMA,GAAOY,OACb,IAAI+F,GAAU,EAWd3G,EAAI1H,iBAAiB7D,EAVR,WACPkS,IAGJA,GAAU,EACV/F,OAAOgG,sBAAsB,WAC3B5G,EAAItF,cAAc,IAAIkG,OAAOpM,YAAYkS,IACzCC,GAAU,OAKhBE,CAAS,SAAU,mBAEnBrK,EAAe1E,OAAO,WAAY,CAChC6J,YAAaxH,GACXjF,KAAK0M,QAAUzH,EAAMyC,cACrB1H,KAAK4R,UACLlG,OAAOtI,iBAAiB,kBAAmBpD,OAE7CyM,oBACEzM,KAAK4R,WAEPnF,UACE,MAAMoF,EAAO7R,KAAK0M,QAAQoF,YAC1BrS,SAAS6L,KAAKyG,MAAMC,YAAY,kBAAmBH,EAAO,MACtDA,EAAO,IACTpS,SAAS6L,KAAKgB,UAAUnM,IAAI,6BAE5BV,SAAS6L,KAAKgB,UAAUQ,OAAO,gCCjCrC,IAAImF,EAA0C,GAC9C,IAAMA,EAAKlS,QAAUA,QACrB,MAAOA,GAGLkS,EAAKlS,QAAW,SAAUmS,EAAItR,GAC5B,IAAIuR,EAAKvR,EAAOC,eACZuR,EAAMxR,EAAOI,eACbqR,EAAQtS,EAAQG,UAcpB,OAbAmS,EAAM9R,OAAS,SAAUuH,GACvB,OAAO9H,KAAKM,IAAIwH,WAAeA,EAAI9H,KAAKsS,IAE1CD,EAAMvO,IAAM,SAAUgE,GACpB,OAAO9H,KAAKM,IAAIwH,GAAOA,EAAI9H,KAAKsS,QAAK,GAEvCD,EAAM/R,IAAM,SAAUwH,GACpB,OAAOsK,EAAInR,KAAK6G,EAAK9H,KAAKsS,IAE5BD,EAAMhS,IAAM,SAAUyH,EAAKhH,GAEzB,OADAqR,EAAGrK,EAAK9H,KAAKsS,EAAG,CAACvR,cAAc,EAAMD,MAAOA,IACrCd,MAEFD,EACP,SAASA,EAAQwS,GACfJ,EAAGnS,KAAM,IAAK,CAACc,MAAO,kBAAoBoR,MACtCK,GACFA,EAAS3F,QAAQzM,EAAKH,MAE1B,SAASG,EAAIqS,GACXxS,KAAKK,IAAImS,EAAK,GAAIA,EAAK,MAEzB/R,KAAKC,SAAUE,QAEnB,MAAeqR,EAAKlS,QCjChB0S,EAAmB,WACrB,IACIC,EAA6B,iBAAbjT,SAChBgT,EAAkB,SAAUE,GAC9B,KAHQ,QAKGA,IAETA,EAAGC,qBAPG,SASLhS,OAAOiS,SAASF,EAAM,MAGrB,iBAAiBG,MACdrT,SAASsT,YAAYC,WAAa,IAAIC,YAEzCC,WAAWC,OAAOC,IAAM,GAE1B,CACA,IAAIC,EAAU,GACdZ,EAAkB,SAAUE,GAC1B,IAAK,IAAI7K,EAAM,IAAKtH,EAAI,EAAGA,EAAImS,EAAGrR,OAAQd,IACxCsH,GAAO6K,EAAGnS,GAAGc,OAAS,IAAMqR,EAAGnS,GACjC,OAAO6S,EAAQvL,KAASuL,EAAQvL,GAAO6K,SAGzCD,GAAS,EAEX,OAAOY,EAAGX,IAEZ,OAAOW,EACP,SAASA,EAAGX,GACV,OAAOD,EAASC,EAAKF,EAAgBE,OC/B1B,WAAUY,GAIvB,IAHA,IAAIjS,EAASD,UAAUC,OACnBkS,EAAO,CAACC,EAAOF,IACf/S,EAAI,EACDA,EAAIc,GACTkS,EAAK7P,KAAKtC,UAAUb,MACtB,OAAOgT,ECPT,IAAIE,EAAQ,SAAUvN,EAAOkM,GAmC3B,OAjCAA,EAAQqB,EAAKxT,WAEPyT,aAAe,EACrBtB,EAAMzO,SAAW,IAEjByO,EAAMvF,OAAS,SAAU8G,GACvB,IAAIxJ,EAAapK,KAAKoK,WAClByJ,EAAQ7T,KAAKmN,WACb2G,EAAO9T,KAAKqN,UAEhB,GADArN,KAAKsS,EAAI,KACLsB,GAAmC,IAAtBxJ,EAAW9I,OAC1BwS,EAAKpS,WAAWwN,YAAY4E,OACvB,CACL,IAAI9G,EAAQhN,KAAK2F,cAAcsH,cAC/BD,EAAME,eAAe0G,EAAYxJ,EAAW,GAAKyJ,GACjD7G,EAAMI,YAAY0G,GAClB9G,EAAM+G,iBAER,OAAOF,GAGTxB,EAAM2B,QAAU,SAAUC,GACxB,IAAI3G,EAAWtN,KAAKsS,EAChB4B,EAAyB,MAAZ5G,EAGjB,GAFI4G,IACF5G,EAAYtN,KAAKsS,EAAItS,KAAK2F,cAAcwO,0BACtCD,GAAcD,EAChB,IAAK,IAAI7L,EAAIpI,KAAKoK,WAAY5J,EAAI,EAAG0J,EAAI9B,EAAE9G,OAAQd,EAAI0J,EAAG1J,IACxD8M,EAASd,YAAYpE,EAAE5H,IAE3B,OAAO8M,GAGFoG,EAEP,SAASA,EAAKtJ,GACZ,IAAI/E,EAASrF,KAAKoK,WAAajE,EAAMlF,KAAKmJ,EAAY,GACtDpK,KAAKmN,WAAa9H,EAAM,GACxBrF,KAAKqN,UAAYhI,EAAMA,EAAM/D,OAAS,GACtCtB,KAAK2F,cAAgBN,EAAM,GAAGM,cAC9B3F,KAAKsS,EAAI,OAGX,GAAGnM,OC5CL,MAAMiO,QAACA,GAAWlO,MACZmO,EAAWX,EAAKxT,UAAU0D,SCFhC,IAAI0Q,EAAiB,SAAU7U,GAC7B,IAAI8U,EAAW,WAIXC,EAFc,YAAanN,EADhB,YAIb,SAAU0H,GACR,IAAIwE,EAAWlM,EALJ,YAOX,OADAkM,EAASnE,UAAYL,EACdwE,EAAStD,SAElB,SAAUlB,GACR,IAAIkB,EAAU5I,EAAOkN,GACjBhB,EAAWlM,EAXJ,YAYP+C,EAAa,KACjB,GAAI,sDAAsD0I,KAAK/D,GAAO,CACpE,IAAIjN,EAAWqR,OAAOC,GACtBG,EAASnE,UAAY,UAAYL,EAAO,WACxC3E,EAAamJ,EAASlR,iBAAiBP,QAEvCyR,EAASnE,UAAYL,EACrB3E,EAAamJ,EAASnJ,WAGxB,OADAqK,EAAOxE,EAAS7F,GACT6F,GAGX,OAAO,SAAuByE,EAAQnV,GACpC,OAAiB,QAATA,EAkBV,SAAmBoV,GACjB,IAAI1E,EAAU5I,EAAOkN,GACjBhB,EAAWlM,EAAO,OAGtB,OAFAkM,EAASnE,UAAY,2CAA6CuF,EAAM,SACxEF,EAAOxE,EAASsD,EAASpG,WAAW/C,YAC7B6F,GAvB8BuE,GAAYE,IAGnD,SAASD,EAAOG,EAAMxK,GAEpB,IADA,IAAI9I,EAAS8I,EAAW9I,OACjBA,KACLsT,EAAKpI,YAAYpC,EAAW,IAGhC,SAAS/C,EAAOqF,GACd,OAAOA,IAAY6H,EACjB9U,EAAS0U,yBACT1U,EAASoV,gBAAgB,+BAAgCnI,KAc7DjN,UCtDEwS,EAA0C,GAC9C,IAAMA,EAAK6C,IAAMA,IACjB,MAAOA,GACL7C,EAAK6C,IAAM,WACT,IAAItU,EAAI,EACJe,EAAI,GACJwT,EAAI,GACR,MAAO,CACLxU,OAAQ,SAAUuH,GAChB,IAAIkN,EAAMxT,EAASsG,GAKnB,OAJIkN,IACFzT,EAAEyD,OAAOxE,EAAG,GACZuU,EAAE/P,OAAOxE,EAAG,IAEPwU,GAETlR,IAAK,SAAagE,GAChB,OAAOtG,EAASsG,GAAOiN,EAAEvU,QAAK,GAEhCF,IAAK,SAAawH,GAChB,OAAOtG,EAASsG,IAElBzH,IAAK,SAAayH,EAAKhH,GAErB,OADAiU,EAAEvT,EAASsG,GAAOtH,EAAKe,EAAEoC,KAAKmE,GAAO,GAAMhH,EACpCd,OAGX,SAASwB,EAASuT,GAEhB,OAAQ,GADRvU,EAAIe,EAAEI,QAAQoT,MAKpB,MAAe9C,EAAK6C,IChCb,MAAML,EAAS,CAAC3Q,EAAKwM,EAAQ7K,EAAU8C,EAAOwD,EAAKzB,KACxD,GAAKyB,EAAMxD,EAAS,EAClB+H,EAAO2E,aAAanR,EAAI2B,EAAS8C,GAAQ,GAAI+B,OAC1C,CACH,MAAMgD,EAAWgD,EAAO3K,cAAcwO,yBACtC,KAAO5L,EAAQwD,GACbuB,EAASd,YAAY1I,EAAI2B,EAAS8C,KAAU,IAC9C+H,EAAO2E,aAAa3H,EAAUhD,KAIrB4K,EAAO,CAACC,EAAGC,IAAMD,GAAKC,EAEtBC,EAAWjV,GAAKA,EAEhBuB,EAAU,CACrB2T,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,KAEA,MAAMtU,EAASqU,EAAUD,EAEzB,GAAIpU,EAAS,EACX,OAAQ,EACV,KAAQkU,EAAUD,GAAcjU,GAAQ,CACtC,IAAIuU,EAAIN,EACJrL,EAAIwL,EACR,KACEG,EAAIL,GACJtL,EAAIyL,GACJC,EAAQN,EAAUO,GAAIJ,EAAUvL,KAEhC2L,IACA3L,IAEF,GAAIA,IAAMyL,EACR,OAAOJ,EACTA,EAAYM,EAAI,EAElB,OAAQ,GAuBGC,EAAO,CAAChS,EAAK+M,EAAMrQ,EAAGc,EAAQgJ,IAAW9J,EAAIc,EAC5CwC,EAAI+M,EAAKrQ,GAAI,GACZ,EAAIA,EACHsD,EAAI+M,EAAKrQ,EAAI,IAAK,GAAGuV,YACrBzL,EAEHwC,EAAS,CAAChJ,EAAKwM,EAAQ7K,EAAU8C,EAAOwD,KACnD,GAAKA,EAAMxD,EAAS,EAClB+H,EAAOpB,YAAYpL,EAAI2B,EAAS8C,IAAS,QACtC,CACH,MAAMyE,EAAQsD,EAAO3K,cAAcsH,cACnCD,EAAME,eAAepJ,EAAI2B,EAAS8C,IAAS,IAC3CyE,EAAMI,YAAYtJ,EAAI2B,EAASsG,EAAM,IAAK,IAC1CiB,EAAM+G,mBAyOJiC,EAAQ,CAACC,EAAK3U,EAAQ4U,KAC1B,IAAIC,EAAK,EACLC,EAAK9U,EACT,KAAO6U,EAAKC,GAAI,CACd,MAAMC,GAAQF,EAAKC,GAAM,IAAO,EAC5BF,EAAID,EAAII,GACVD,EAAKC,EAELF,EAAKE,EAAM,EAEf,OAAOF,GAGIG,GAAY,CACvBxS,EACApC,EACA6U,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAnB,EACAtL,KAzFgB,EAChB0M,EACAlT,EACApC,EACA6U,EACAC,EACAG,EACAC,EACAG,EACAzM,KAEA,MAAM2M,EAAO,IAAInC,EACXxT,EAAS0V,EAAK1V,OACpB,IAAI4V,EAAeN,EACfpW,EAAI,EACR,KAAOA,EAAIc,GACT,OAAQ0V,EAAKxW,MACX,KAjLO,EAkLLgW,IACAU,IACA,MACF,KAtLY,EAwLVD,EAAK5W,IAAIkW,EAAYC,GAAc,GACnC/B,EACE3Q,EACApC,EACA6U,EACAC,IACAA,EACAU,EAAeH,EACbjT,EAAI6S,EAAaO,GAAe,GAChC5M,GAEJ,MACF,KArMW,EAsMT4M,IAKN,IADA1W,EAAI,EACGA,EAAIc,GACT,OAAQ0V,EAAKxW,MACX,KA3MO,EA4MLoW,IACA,MACF,KAhNW,EAkNLK,EAAK3W,IAAIqW,EAAaC,IACxBA,IAEA9J,EACEhJ,EACApC,EACAiV,EACAC,IACAA,KAmCVO,CA3KU,EACVZ,EACAC,EACAY,EACAT,EACAC,EACAS,EACAzB,KAEA,MAAMtU,EAAS8V,EAAOC,EAChBtC,EAAI,GACV,IAAIuC,EAAG/V,EAAG8I,EAAGkN,EAAGC,EAAIC,EAAIC,EACxBC,EAAO,IAAKL,EAAI,EAAGA,GAAKhW,EAAQgW,IAAK,CAEnC,GAAIA,EA7FS,GA8FX,OAAO,KAKT,IAJAI,EAAKJ,EAAI,EAETE,EAAKF,EAAIvC,EAAEuC,EAAI,GAAK,CAAC,EAAG,GACxBG,EAAK1C,EAAEuC,GAAK,GACP/V,GAAK+V,EAAG/V,GAAK+V,EAAG/V,GAAK,EAAG,CAO3B,IADA8I,GAJEkN,EADEhW,KAAO+V,GAAM/V,IAAM+V,GAAKE,EAAGE,EAAKnW,EAAI,GAAKiW,EAAGE,EAAKnW,EAAI,GACnDiW,EAAGE,EAAKnW,EAAI,GAEZiW,EAAGE,EAAKnW,EAAI,GAAK,GAEfA,EAENgW,EAAIF,GACJhN,EAAI+M,GACJxB,EACEe,EAAaC,EAAeW,GAC5BhB,EAAYC,EAAcnM,KAG5BkN,IACAlN,IAEF,GAAIkN,IAAMF,GAAQhN,IAAM+M,EACtB,MAAMO,EAERF,EAAGH,EAAI/V,GAAKgW,GAIhB,MAAMP,EAAO9Q,MAAMoR,EAAI,EAAIhW,EAAS,GACpC,IAAIsW,EAAUZ,EAAK1V,OAAS,EAC5B,IAAKgW,EAAIvC,EAAEzT,OAAS,EAAGgW,GAAK,EAAGA,IAAK,CAClC,KACEC,EAAI,GACJlN,EAAI,GACJuL,EACEe,EAAaC,EAAeW,EAAI,GAChChB,EAAYC,EAAcnM,EAAI,KAIhC2M,EAAKY,KAzIE,EA0IPL,IACAlN,IAEF,IAAKiN,EACH,MACFI,EAAKJ,EAAI,EAETE,EAAKF,EAAIvC,EAAEuC,EAAI,GAAK,CAAC,EAAG,IACxB/V,EAAIgW,EAAIlN,KACGiN,GAAM/V,IAAM+V,GAAKE,EAAGE,EAAKnW,EAAI,GAAKiW,EAAGE,EAAKnW,EAAI,IAEvD8I,IACA2M,EAAKY,KAvJO,IA0JZL,IACAP,EAAKY,MA5JM,GA+Jf,OAAOZ,GA+FLa,CACEtB,EACAC,EACAE,EACAC,EACAC,EACAE,EACAlB,IAhQK,EACTW,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,KAGA,IAAIvV,EAAI,EAEJuW,EAASpB,EAAgBI,EAAiBJ,EAAgBI,EAC9D,MAAMiB,EAAO7R,MAAM4R,KACbE,EAAQ9R,MAAM4R,GACpBE,EAAM,IAAM,EAEZ,IAAK,IAAIxX,EAAI,EAAGA,EAAIsX,EAAQtX,IAC1BwX,EAAMxX,GAAKqW,EAEb,MAAMoB,EAAS,IAAInD,EACnB,IAAK,IAAItU,EAAIoW,EAAcpW,EAAIqW,EAAYrW,IACzCyX,EAAO5X,IAAIsW,EAAanW,GAAIA,GAE9B,IAAK,IAAIA,EAAIgW,EAAahW,EAAIiW,EAAWjW,IAAK,CAC5C,MAAM0X,EAAWD,EAAOnU,IAAIyS,EAAY/V,IACxB,MAAZ0X,IAGG,GAFL3W,EAAIyU,EAAMgC,EAAOF,EAAQI,MAGvBF,EAAMzW,GAAK2W,EACXH,EAAKxW,GAAK,CACR4W,KAAM3X,EACN4X,KAAMF,EACNG,KAAMN,EAAKxW,EAAI,KAQvB,IAFAA,IAAMuW,IACJjB,EACKmB,EAAMzW,GAAKsV,KAActV,EAEhCuW,EAAShB,EAAiBJ,EAAgBnV,EAC1C,MAAMyV,EAAO9Q,MAAM4R,GACnB,IAAIQ,EAAMP,EAAKxW,GAEf,MADEkV,EACK6B,GAAK,CACV,MAAMH,KAACA,EAAIC,KAAEA,GAAQE,EACrB,KAAO7B,EAAY0B,GACjBnB,IAAOc,GAxDK,IAyDVrB,EAEJ,KAAOI,EAAauB,GAClBpB,IAAOc,IA7DI,IA8DTjB,EAEJG,IAAOc,GA9DE,IA+DPrB,IACAI,EACFyB,EAAMA,EAAID,KAEZ,KAAO5B,GAAaD,GAClBQ,IAAOc,GArEO,IAsEZrB,EAEJ,KAAOI,GAAcD,GACnBI,IAAOc,IA1EM,IA2EXjB,EAEJ,OAAOG,GA0LLuB,CACEhC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEFhT,EACApC,EACA6U,EACAC,EACAG,EACAC,EACAG,EACAzM,ICzWEkO,GAAU,CACd9W,EACAiV,EACAJ,EACA1T,KAKKA,IACHA,EAAU,IAEZ,MAAM+S,EAAU/S,EAAQ+S,SAAWV,EAC7BpR,EAAMjB,EAAQ2B,MAAQ6Q,EACtB/K,EAA2B,MAAlBzH,EAAQyH,OAAiB,KAAOxG,EAAIjB,EAAQyH,OAAQ,GAE7DyM,EAAgBJ,EAAarV,OACnC,IAAIuV,EAAaE,EACbH,EAAe,EAEfH,EAAYF,EAAYjV,OACxBkV,EAAc,EAGlB,KACEI,EAAeC,GACfL,EAAcC,GACdb,EAAQe,EAAaC,GAAeL,EAAYC,KAEhDI,IACAJ,IAIF,KACEI,EAAeC,GACfL,EAAcC,GACdb,EAAQe,EAAaE,EAAa,GAAIN,EAAYE,EAAY,KAE9DI,IACAJ,IAGF,MAAMgC,EAAc7B,IAAiBC,EAC/B6B,EAAalC,IAAgBC,EAGnC,GAAIgC,GAAeC,EACjB,OAAOnC,EAGT,GAAIkC,GAAejC,EAAcC,EAS/B,OARAhC,EACE3Q,EACApC,EACA6U,EACAC,EACAC,EACAX,EAAKhS,EAAK6S,EAAcC,EAAcG,EAAezM,IAEhDiM,EAIT,GAAImC,GAAc9B,EAAeC,EAQ/B,OAPA/J,EACEhJ,EACApC,EACAiV,EACAC,EACAC,GAEKN,EAGT,MAAMO,EAAiBD,EAAaD,EAC9BF,EAAgBD,EAAYD,EAClC,IAAIhW,GAAK,EAGT,GAAIsW,EAAiBJ,GAWnB,IAAK,GAVLlW,EAAImB,EACF4U,EACAC,EACAC,EACAE,EACAC,EACAC,EACAjB,IAoBA,OAhBAnB,EACE3Q,EACApC,EACA6U,EACAC,EACAhW,EACAsD,EAAI6S,EAAaC,GAAe,IAElCnC,EACE3Q,EACApC,EACA6U,EACA/V,EAAIsW,EACJL,EACAX,EAAKhS,EAAK6S,EAAcE,EAAYE,EAAezM,IAE9CiM,OAIN,GAAIG,EAAgBI,IAWlB,GAVLtW,EAAImB,EACFgV,EACAC,EACAC,EACAN,EACAC,EACAC,EACAb,IAkBA,OAdA9I,EACEhJ,EACApC,EACAiV,EACAC,EACApW,GAEFsM,EACEhJ,EACApC,EACAiV,EACAnW,EAAIkW,EACJG,GAEKN,EAOX,OAAKO,EAAiB,GAAKJ,EAAgB,GACzCjC,EACE3Q,EACApC,EACA6U,EACAC,EACAC,EACA3S,EAAI6S,EAAaC,GAAe,IAElC9J,EACEhJ,EACApC,EACAiV,EACAC,EACAC,GAEKN,GAYPO,IAAmBJ,GDrIG,EACxBH,EACAE,EACAE,EACAC,EACAC,EACAjB,KAEA,KACEgB,EAAeC,GACfjB,EACEe,EAAaC,GACbL,EAAYE,EAAY,KAExBG,IACAH,IAEJ,OAAqB,IAAdA,GCqHLkC,CACEpC,EACAE,EACAE,EACAC,EACAC,EACAjB,IAGFnB,EACE3Q,EACApC,EACA6U,EACAC,EACAC,EACAX,EAAKhS,EAAK6S,EAAcE,EAAYE,EAAezM,IAE9CiM,IAITD,GACExS,EACApC,EACA6U,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAnB,EACAtL,GAGKiM,IC1NT,ICEgBhD,GDFZqF,GAAc,SAChBnZ,EACA+M,EACAqM,EACAC,EACAF,GAEA,IAAIG,EAgCJ,eAhC2BtZ,EAGvB6N,EAAW7N,EAAS0U,yBAMxB,OALA7G,EAAoB,YAAE7N,EAAuB,eAAE,MAC/C6N,EAAoB,YAAE7N,EAAuB,eAAE,MACjCsZ,EACZtZ,EAAmB,WAAE6N,GAAU,GAC/BA,EAAkB,WAAE,IACPlD,WAAW9I,OAAS,EACjC,SAASsX,EAAWpU,EAAMwU,GAExB,IADA,IAAIC,EAAQzU,EAAc,YAExB4F,EAAa5F,EAAK4F,YAAc,GAChC9I,EAAS8I,EAAW9I,OACpBd,EAAI,EAAGwY,GAAQxY,EAAIc,EAAQd,IAE3ByY,EAAiB,YAAEL,EAAWxO,EAAW5J,GAAIwY,IAE/C,OAAOC,GAERF,EACCtZ,EAAmB,WACnB,SAAU+E,EAAMwU,GACd,OAAOxU,EAAc,YAAIwU,KAI/BvZ,UEpCEyZ,GAAO,GAAGA,MAAQ,WACpB,OAAOC,OAAOnZ,MAAMoZ,QAAQ,YAAa,KDAvCC,GAAM,IAAM5Y,KAAKC,SAAS4Y,QAAQ,GAAK,IAOL,YALtB/F,GAKd9T,SAAS2M,cAAc,eAHpBmH,GAASnE,UAAY,gBAA0BiK,GAAM,SACtD9F,GAAgB,QAAEnJ,WAAW,GAAGzD,aAEa,aAFa0S,MAG5DA,GAAM,QAAUA,GAAIlT,MAAM,GAAI,GAAK,KAErC,IAAIoT,GAAO,UAASF,GAAM,SAGtBG,GAAe,EAEf7F,GAAe,EACfpK,GAAY,EAEZkQ,GAA0B,wBAC1BC,GAAgB,8FEZpB,IAAIC,GAAS,gBAETrT,GAAW,KAAOqT,GAAS,+BAC3BxR,GAAU,kCACVyR,GAAe,8EAEfC,GAAa,IAAI1G,OAAOhL,GAAU7B,GAAWsT,GAAe,QAAUD,GAAS,SAAU,KACzFG,GAAc,IAAI3G,OAAOhL,GAAU7B,GAAWsT,GAAe,QAAUD,GAAS,QAAS,KACzFI,GAAiB,IAAI5G,OAAO,IAAM7M,GAAW,qBAAuBiT,GAAO,MAAO,MAEtF,SAASS,GAAaC,EAAI7G,EAAI8G,EAAIC,GAChC,MAAO,IAAM/G,EAAK8G,EAAGd,QAAQW,GAAgBK,IAAqBD,EAGpE,SAASC,GAAkBH,EAAI7G,EAAI8G,GACjC,OAAO9G,GAAM8G,GAAM,KAAOb,IAAOa,GAAM,KAGzC,SAASG,GAAYJ,EAAI7G,EAAI8G,GAC3B,OAAOR,GAAc5G,KAAKM,GAAM6G,EAAM,IAAM7G,EAAK8G,EAAK,MAAQ9G,EAAK,ICdrE,SAAS/L,GAAO9H,EAAMiF,EAAM8V,EAAM9I,GAChC,MAAO,CAACA,KAAMA,EAAMhN,KAAMA,EAAM8V,KAAMA,EAAM/a,KAAMA,GAGpD,SAASgb,GAAK/V,EAAM8V,GAGlB,IAFA,IAAIhZ,EAASgZ,EAAKhZ,OACdd,EAAI,EACDA,EAAIc,GACTkD,EAAOA,EAAK4F,WAAWkQ,EAAK9Z,MAC9B,OAAOgE,EA+CT,SAASgW,GAAgBhW,EAAMiW,EAAOC,EAAOJ,GAO3C,IANA,IAAIK,EAAQ,IAAI7F,EACZ/O,EAAavB,EAAKuB,WAClB+G,EAAS,GACT8N,EAAQ9N,EAAO3G,MAAMlF,KAAK8E,EAAY,GACtCzE,EAASsZ,EAAMtZ,OACfd,EAAI,EACDA,EAAIc,GAAQ,CACjB,IAAIuZ,EAAYD,EAAMpa,KACtB,GAAIqa,EAAU/Z,QAAUuY,GAAK,CAC3B,IAAI7H,EAAOqJ,EAAUrJ,KAIrB,IAAKmJ,EAAMra,IAAIkR,GAAO,CACpB,IAAIsJ,EAAWJ,EAAMzQ,QAAQmP,QAAQ,sCAAuC,MACxEtY,EAAQiF,EAAW+U,IAIT/U,EAAW+U,EAASC,eAClCJ,EAAMta,IAAImR,EAAM1Q,GAChB2Z,EAAM9W,KAAK0D,GAAO,OAAQvG,EAAOwZ,EAAMQ,IAEzChO,EAAOnJ,KAAKkX,IAKhB,IAFAvZ,EAASwL,EAAOxL,OAChBd,EAAI,EACGA,EAAIc,GAAQ,CAEjB,IAAI0Z,EAAOlO,EAAOtM,KACd,QAAQsS,KAAKkI,EAAKxJ,MACpBhN,EAAKyW,gBAAgBD,EAAKxJ,MAG1BhN,EAAK0W,oBAAoBF,GAS7B,IAAIG,EAAW3W,EAAK2W,SACpB,GAAI,YAAYrI,KAAKqI,GAAW,CAM9B,IAAIC,EAAS3b,SAAS2M,cAAc+O,GAGpC,IAFA7Z,EAASyE,EAAWzE,OACpBd,EAAI,EACGA,EAAIc,GACT8Z,EAAOC,iBAAiBtV,EAAWvF,KAAKqY,WAAU,IACpDuC,EAAO7P,YAAc/G,EAAK+G,YAC1B/G,EAAK9C,WAAW6K,aAAa6O,EAAQ5W,IChHzC,IAAI8W,GAAS,IAAIvb,EACbwb,GAAa,IAAIxb,EAErB,SAASyb,GAAW3Y,EAAS0Q,GAC3B,IAAImB,EFjBS,SAAUnB,GACvB,OAAOA,EAAS5S,KAAK4Y,IACZH,QAAQU,GAAaO,IACrBjB,QAAQS,GAAYG,IEchByB,CAASlI,GAClBmI,EAAY7Y,EAAQ6Y,UACpBA,IACFhH,EAASgH,EAAUhH,IACrB,IAAIzE,EAAUqE,EAAcI,EAAQ7R,EAAQtD,OAoE9C,SAAsB+N,GACpB,IAAIlD,EAAakD,EAASlD,WACtB5J,EAAI4J,EAAW9I,OACnB,KAAOd,KAAK,CACV,IAAImb,EAAQvR,EAAW5J,GAEF,IAAnBmb,EAAM/X,UACkC,IAAxCsV,GAAKjY,KAAK0a,EAAMpQ,aAAajK,QAE7BgM,EAAS4B,YAAYyM,IA5EzBC,CAAa3L,GACb,IAAIwK,EAAQ,IDAd,SAASoB,EAAMrX,EAAMiW,EAAOC,EAAOJ,GAIjC,IAHA,IAAIlQ,EAAa5F,EAAK4F,WAClB9I,EAAS8I,EAAW9I,OACpBd,EAAI,EACDA,EAAIc,GAAQ,CACjB,IAAIqa,EAAQvR,EAAW5J,GACvB,OAAQmb,EAAM/X,UACZ,KAAK+P,GACH,IAAImI,EAAYxB,EAAKzQ,OAAOrJ,GAC5Bga,GAAgBmB,EAAOlB,EAAOC,EAAOoB,GACrCD,EAAMF,EAAOlB,EAAOC,EAAOoB,GAC3B,MACF,KAAKtC,GACCmC,EAAMpQ,cAAgB8N,KACxBqB,EAAMzQ,QACNwQ,EAAM9W,KAIJ8V,GAAwB3G,KAAKtO,EAAK2W,UAChC9T,GAAO,OAAQ7C,EAAM8V,GACrBjT,GAAO,MAAOsU,EAAOrB,EAAKzQ,OAAOrJ,MAGvC,MACF,KAAK+I,GAODkQ,GAAwB3G,KAAKtO,EAAK2W,WAClCjC,GAAKjY,KAAK0a,EAAMpQ,eAAiBgO,KAEjCmB,EAAMzQ,QACNwQ,EAAM9W,KAAK0D,GAAO,OAAQ7C,EAAM8V,KAItC9Z,KCvCFqb,CAAM5L,EAASwK,EAAOlH,EAASpN,MAAM,GAAI,IACzC,IAAI4V,EAAO,CACT9L,QAASA,EACT+L,QAAS,SAAU/L,GAIjB,IAHA,IAAIgM,EAAY,GACZzT,EAAMiS,EAAMnZ,OACZd,EAAI,EACDA,EAAIgI,GAAK,CACd,IAAIuT,EAAOtB,EAAMja,KACbgE,EAAO+V,GAAKtK,EAAS8L,EAAKzB,MAC9B,OAAQyB,EAAKxc,MACX,IAAK,MACH0c,EAAUtY,KAAKd,EAAQqZ,IAAI1X,EAAM,KACjC,MACF,IAAK,OACHyX,EAAUtY,KAAKd,EAAQgY,UAAUrW,EAAMuX,EAAKvK,KAAMuK,EAAKvX,OACvD,MACF,IAAK,OACHyX,EAAUtY,KAAKd,EAAQuI,KAAK5G,IAC5BA,EAAK+G,YAAc,IAIzB,OAAO,WACL,IAAIjK,EAASD,UAAUC,OACnB6a,EAAS7a,EAAS,EAClBd,EAAI,EACR,GAAIgI,IAAQ2T,EACV,MAAM,IAAIzY,MACRyY,EAAS,sBAAwB3T,EAAM,KACvC+K,EAAS5S,KAAK,OAGlB,KAAOH,EAAIc,GACT2a,EAAUzb,EAAI,GAAGa,UAAUb,MAC7B,OAAOyP,KAKb,OADAqL,GAAOjb,IAAIkT,EAAUwI,GACdA,EAeT,SAASK,GAAUvZ,GACjB,OAAO,SAAU0Q,GACf,IAAI8I,EAAUd,GAAWzX,IAAIjB,GAI7B,OAHe,MAAXwZ,GAAmBA,EAAQ9I,WAAaA,IAC1C8I,EAhBN,SAAuBxZ,EAAS0Q,GAC9B,IAAIwI,EAAOT,GAAOxX,IAAIyP,IAAaiI,GAAW3Y,EAAS0Q,GACnDtD,EAAU2I,GAAW3X,KAAKxB,SAAUsc,EAAK9L,SAAS,GAClDoM,EAAU,CACZpM,QAASA,EACTsD,SAAUA,EACVyI,QAASD,EAAKC,QAAQ/L,IAGxB,OADAsL,GAAWlb,IAAIwC,EAASwZ,GACjBA,EAOOC,CAAczZ,EAAS0Q,IACnC8I,EAAQL,QAAQO,MAAM,KAAMlb,WACrBgb,EAAQpM,SCtFnB,IAAIuM,GAAc,WAEhB,IAAIC,EAAqB,yDACrBC,EAAS,oBACb,OAAO,SAAoBlY,EAAMmY,GAC/B,MAAO,oBAAqBnY,EAK9B,SAAaA,EAAMmY,GACjB,IAAI5K,EACA4K,EACF5K,EAAQ4K,EAAS9D,WAAU,IAE3BrU,EAAKoY,aAAa,QAAS,kBAC3B7K,EAAQvN,EAAKqY,iBAAiB,UAIhC,OAFA9K,EAAMjR,MAAQ,GACd0D,EAAK6W,iBAAiBtJ,GACf+K,EAAO/K,GAAO,GAfc4C,CAAInQ,EAAMmY,GAAYG,EAAOtY,EAAKuN,OAAO,IAE9E,SAASgL,EAAK9C,EAAI7G,EAAI8G,GACpB,OAAO9G,EAAK,IAAM8G,EAAGa,cAoBvB,SAAS+B,EAAO/K,EAAOiL,GACrB,IAAIC,EAASxW,EACb,OAAO,SAAUC,GACf,IAAIqV,EAAMjU,EAAKoV,EAAYpc,EAC3B,cAAe4F,GACb,IAAK,SACH,GAAIA,EAAU,CACZ,GAAgB,WAAZuW,GACF,IAAKD,GACCvW,IAAaC,EACf,IAAKoB,KAAOrB,EACJqB,KAAOpB,IACXqL,EAAMjK,GAAO,SAMjBkV,EACFjL,EAAMjR,MAAQ,GAEdiR,EAAMoL,QAAU,GAGpB,IAAKrV,KADLiU,EAAOiB,EAAQ,GAAKjL,EACRrL,EAEVwW,EAA8B,iBAD9Bpc,EAAQ4F,EAASoB,KAEI2U,EAAmB3J,KAAKhL,GACRhH,EAAhBA,EAAQ,MACxBkc,GAAS,MAAMlK,KAAKhL,GACvBiU,EAAK/J,YAAYlK,EAAKoV,GAEtBnB,EAAKjU,GAAOoV,EAEhBD,EAAU,SACND,EACFjL,EAAMjR,MA1ClB,SAAiBoP,GACf,IAAIpI,EAAKd,EAAM,GACf,IAAKc,KAAOoI,EACVlJ,EAAIrD,KAAKmE,EAAIsR,QAAQsD,EAAQK,GAAO,IAAK7M,EAAOpI,GAAM,KACxD,OAAOd,EAAIrG,KAAK,IAsCQyc,CAAS3W,EAAWsV,GAElCtV,EAAWC,EACb,MAEJ,QACMD,GAAYC,IACduW,EAAU,SACVxW,EAAWC,EACPsW,EACFjL,EAAMjR,MAAQ4F,GAAY,GAE1BqL,EAAMoL,QAAUzW,GAAY,UCtE1C,MAGM2W,GAAS,CAACC,EAAM9c,IAAM8c,EAAK1Z,WAAayQ,EAEzC,EAAI7T,EAAK,EACPA,EAAI8c,EAAKxQ,QAAO,GAAQwQ,EAAKjQ,UAC7B7M,EAAI8c,EAAKtJ,SAAQ,GAAQsJ,EAAKnQ,WAEnCmQ,EAkDIC,GAAgB,CAAC/Y,EAAMgN,KAC3B,IAAI/K,EACJ,OAAOC,IACDD,IAAaC,IACfD,EAAWC,EACPlC,EAAKgN,KAAU9K,IACjBlC,EAAKgN,GAAQ9K,EACG,MAAZA,GACFlC,EAAKyW,gBAAgBzJ,OAezBgM,GAAW,mBAGXrX,GAAQ,GAAGA,MAGXiF,GAAO,CAAC5G,EAAM4G,IAAS5G,EAAKmB,cAAcmT,eAAe1N,GAEhD,SAASqS,GAAOle,GAE7B,OADAS,KAAKT,KAAOA,EACL6c,GAAUpc,MA0LnB,SAAS6H,GAAO6V,GACd,OAAOA,EAAS1d,MAxLlByd,GAAOvd,UAAY,CASjBuM,UAAUjI,EAAMgN,EAAMmL,GACpB,OAAQnL,GACN,IAAK,QACHA,EAAO,YACT,IAAK,OACL,IAAK,QACH,OAAO+L,GAAc/Y,EAAMgN,GAC7B,IAAK,QACH,OAAOgL,GAAWhY,EAAMmY,EAhHN,oBAgHqCnY,GACzD,IAAK,MACH,MAvCSA,CAAAA,GACRkF,IACLA,EAAIiU,QAAUnZ,GAqCHoZ,CAASpZ,GAClB,QACE,MAAyB,OAArBgN,EAAKrL,MAAM,EAAG,GA1EP,EAAC3B,EAAMgN,KACxB,IAAI/K,EACAlH,EAAOiS,EAAKrL,MAAM,GAGtB,OAFIqL,EAAKuJ,gBAAiBvW,IACxBjF,EAAOA,EAAKwb,eACPrU,IACDD,IAAaC,IACXD,GACFjC,EAAKmD,oBAAoBpI,EAAMkH,GAAU,GAC3CA,EAAWC,EACPA,GACFlC,EAAKpB,iBAAiB7D,EAAMmH,GAAU,MAgE7BmX,CAAWrZ,EAAMgN,GACtBA,KAAQhN,KAtHM,oBAuHKA,GAAQgZ,GAAS1K,KAAKtB,IAEpC+L,GAAc/Y,EAAMgN,GAzGd,EAAChN,EAAMqW,KAC5B,IAAIpU,EACAqX,GAAQ,EACZ,OAAOpX,IACDD,IAAaC,IACfD,EAAWC,EACPmU,EAAU/Z,QAAU4F,IACN,MAAZA,GACEoX,IACFA,GAAQ,EACRtZ,EAAK0W,oBAAoBL,IAE3BA,EAAU/Z,MAAQ4F,IAElBmU,EAAU/Z,MAAQ4F,EACboX,IACHA,GAAQ,EACRtZ,EAAK6W,iBAAiBR,SAyFnBkD,CAAevZ,EAAMmY,EAAS9D,WAAU,MAarDpM,IAAIjI,EAAM4F,GACR,MAAM4T,EAAc,CAACxZ,KAAM6Y,GAAQ/S,OAAQ9F,GACrCZ,EAzIgB,oBAyIgBY,EAAkC,MAAQ,OAChF,IACIiC,EADAwX,GAAW,EAEf,MAAMC,EAAapd,IACjB,cAAeA,GACb,IAAK,SACL,IAAK,SACL,IAAK,UACCmd,EACExX,IAAa3F,IACf2F,EAAW3F,EACXsJ,EAAW,GAAGmB,YAAczK,IAG9Bmd,GAAW,EACXxX,EAAW3F,EACXsJ,EAAaoO,GACXhU,EAAK9C,WACL0I,EACA,CAACgB,GAAK5G,EAAM1D,IACZkd,IAGJ,MACF,IAAK,WACHE,EAAWpd,EAAM0D,IACjB,MACF,IAAK,SACL,IAAK,YACH,GAAa,MAAT1D,EAAe,CACjBmd,GAAW,EACX7T,EAAaoO,GACXhU,EAAK9C,WACL0I,EACA,GACA4T,GAEF,MAEJ,QAGE,GAFAC,GAAW,EACXxX,EAAW3F,EACPsT,EAAQtT,GACV,GAAqB,IAAjBA,EAAMQ,OACJ8I,EAAW9I,SACb8I,EAAaoO,GACXhU,EAAK9C,WACL0I,EACA,GACA4T,SAIJ,cAAeld,EAAM,IACnB,IAAK,SACL,IAAK,SACL,IAAK,UACHod,EAAW/E,OAAOrY,IAClB,MACF,IAAK,WACHod,EAAWpd,EAAMyO,IAAI1H,GAAQrD,IAC7B,MACF,IAAK,SACC4P,EAAQtT,EAAM,MAChBA,EAAQA,EAAM+I,OAAO0S,MAAM,GAAIzb,IAEnC,QACEsJ,EAAaoO,GACXhU,EAAK9C,WACL0I,EACAtJ,EACAkd,OAnMJld,CAAAA,GAAS,iBAAkBA,EAwMtBqd,CAAQrd,GACjBsJ,EAAaoO,GACXhU,EAAK9C,WACL0I,EACmB,KAAnBtJ,EAAM8C,SACJuC,GAAMlF,KAAKH,EAAMsJ,YACjB,CAACtJ,GACHkd,GAEO,SAAUld,EACnBod,EAAW/E,OAAOrY,EAAMsK,OACf,QAAStK,EAClBod,EAAWpd,EAAMob,KACR,SAAUpb,EACnBsJ,EAAaoO,GACXhU,EAAK9C,WACL0I,EACAjE,GAAMlF,KACJqT,EACE,GAAGzK,OAAO/I,EAAMiO,MAAMpO,KAAK,IAC3BiD,GACAwG,YAEJ4T,GAEO,WAAYld,GACrBod,EAAW/X,GAAMlF,KAAKH,MAK9B,OAAOod,GAOTzR,KAAKjI,GACH,IAAIiC,EACJ,MAAM8E,EAAczK,IAClB,GAAI2F,IAAa3F,EAAO,CACtB2F,EAAW3F,EACX,MAAMvB,SAAcuB,EACP,WAATvB,GAAqBuB,EACnB,SAAUA,EACZyK,EAAY4N,OAAOrY,EAAMsK,OAChB,QAAStK,EAClByK,EAAYzK,EAAMob,KACT,SAAUpb,EACnByK,EAAY,GAAG1B,OAAO/I,EAAMiO,MAAMpO,KAAK,KAC9B,WAAYG,GACrByK,EAAYpF,GAAMlF,KAAKH,GAAOH,KAAK,KAEnB,aAATpB,EACTgM,EAAYzK,EAAM0D,IAElBA,EAAK+G,YAAuB,MAATzK,EAAgB,GAAKA,IAI9C,OAAOyK,ICpRA,IAAIxL,EACG,IAAIA,EAEtB,IAAI4d,GAAU,KAqBP,MAAM5O,GAAO4I,GAAM,QACPA,GAAM,OAwBzB,SAASA,GAAMpY,GACb,MAAM6e,EAAK,IAAIre,EAOf,OANAse,EAAIC,IAAM,EAACjJ,EAAUnD,KACnB,MAAMxI,EAAM0U,EAAGta,IAAIuR,IAcrB,SAAaA,GACX,MAAM3L,EAAM,CAACzJ,EAAK,MAElB,OADAme,EAAG/d,IAAIgV,EAAU3L,GACVA,EAjByBrJ,CAAIgV,GAGpC,OAFU,MAANnD,IACFA,EAAK,KACAxI,EAAIwI,IAGb,SAAgBxI,EAAKwI,GACnB,IAAIqM,EAAO,KACX,MAAMte,EAAI,IAAIwd,GAAOle,GACrB,OAAQmK,EAAIwI,GAAM,WAChB,MAAMsM,EAASve,EAAEsc,MAAM,KAAMkC,EAAIlC,MAAM,KAAMlb,YAC7C,OAAOkd,IAASA,EA8FtB,SAAsB/Z,GACpB,MAAM4F,EAAa5F,EAAK4F,YAClB9I,OAACA,GAAU8I,EACjB,OAAkB,IAAX9I,EACL8I,EAAW,GACV9I,EAAS,IAAIoS,EAAKtJ,GAAc5F,EAnGRka,CAAaF,KARpBnX,CAAOqC,EAAKwI,KAEzBmM,EAcP,SAASA,IACP,MAAM7K,EAAOiL,EAAIlC,MAAM,KAAMlb,WAC7B,OAAOsc,GACL,IAAIgB,GAAKpf,EAAMiU,GACf,IAAIiK,GAAOle,GAAMgd,MAAM,KAAM/I,IA0FnC,SAASmL,GAAKpf,EAAMiU,GAClBxT,KAAKT,KAAOA,EACZS,KAAKwT,KAAOA,ECxGd,SAASlC,GAAQsN,EAAWC,GAE1B,OAAO9P,+DADe8P,iEAC6FA,MAAgBD,aAGrItX,EAAe1E,OAAO,2BAA4B,CAChD6J,YAAaxH,GACXjF,KAAKyB,GAAKwD,EAAMyC,cAChB1H,KAAKyB,GAAG2B,iBAAiB,QAASpD,OAEpCyM,QAASxH,GACP,MAAM6Z,EAmBV,SAAiBpS,GACf,MAAMmS,EAAcnS,EAAQL,QAAQwS,YAC9BD,EAAYlS,EAAQnB,YAE1B,OAAOwD,kEADkB8P,6DACsFA,MAAgBD,aAvB3GG,CAAO/e,KAAKyB,IACxB6O,EAAStQ,KAAKyB,GAAGyK,QAAQ,WACzB8S,EAAY1O,EAAOE,cAAc,eACjCqO,EAAc7e,KAAKyB,GAAG4K,QAAQwS,YAC9BI,EAAW3O,EAAOE,wDACoBqO,OAExCI,EACF3O,EAAOpB,YAAY+P,GAEnB3O,EAAO2E,aAAa6J,EAAWE,GAEjC1O,EAAOE,cAAc,WAAW0O,MAAO,GAEzCzS,eAAgBxH,GACdjF,KAAKyB,GAAGkG,oBAAoB,QAAS3H,SAWzCsH,EAAe1E,OAAO,uBAAwB,CAC5C6J,YAAaxH,GACXjF,KAAKyB,GAAKwD,EAAMyC,cAChB1H,KAAKyB,GAAG2B,iBAAiB,QAASpD,OAEpCyM,QAASxH,GACQjF,KAAKyB,GAAGwK,cAChBiD,YAAYlP,KAAKyB,KAE1BgL,eAAgBxH,GACdjF,KAAKyB,GAAGkG,oBAAoB,QAAS3H,SC/GzC,MAAMmf,GAAgB,IAAIzT,OAAO0T,qBA0DjC,SAAyBC,GACvBA,EAAQzS,QAAQ0S,IACVA,EAAMC,kBAAoB,IAC5BJ,GAAcK,UAAUF,EAAMne,QAMpC,SAA6BuL,GAC3B,MAAM0D,EAAQ1D,EAAQL,QAAQ+D,MAG9B,IAAK1D,EAAQ8D,cAAc,eAAgB,CACzC,MAAMc,EAASvC,mHAAqHqB;;mBAGpI1D,EAAQF,YAAY8E,GAEtB,MAAMmO,EAAgB/S,EAAQ8D,cAAc,WAC5C,GAAIiP,EAAe,CACjB,MAAMC,ED/ED3Q;;;;;;;;;UASCuC,GAAO,IAAK;UACZA,GAAO,IAAK;UACZA,GAAO,IAAK;UACZA,GAAO,IAAK;;;;;;UAMZA,GAAO,KAAM;UACbA,GAAO,KAAM;UACbA,GAAO,IAAK;UACZA,GAAO,KAAM;;;;;;UAMbA,GAAO,KAAM;UACbA,GAAO,KAAM;UACbA,GAAO,KAAM;UACbA,GAAO,KAAM;UACbA,GAAO,KAAM;UACbA,GAAO,KAAM;;;;cCgDnBmO,EAAcjT,YAAYkT,IAlBxBC,CAAmBL,EAAMne,YA9DuC,CACpEye,WAAY,aAERC,GAAmB,IAAInU,OAAO0T,qBAmCpC,SAAqBC,GACnB,MAAMS,EAAcT,EAAQU,OAAO,CAAC1H,EAAMsF,IAEtCA,EAAQ4B,kBAAoBlH,EAAKkH,mBACH,IAA9B5B,EAAQ4B,kBAED5B,EAEAtF,GAGN2H,GAEMF,EAAYP,mBAAqBS,GAAQT,oBAClDS,GAAUF,GAFVE,GAAUF,EAIZrgB,SAAS8O,eAAe,WAAWlC,QAAQ4T,gBACzCD,GAAQ7e,OAAOkL,QAAQ+D,OApD0C,CACnE8P,UAAW,EACXN,WAAY,qBAERO,GAAe,IAAIzU,OAAO0T,qBAIhC,SAAuBC,GACrBA,EAAQzS,QAAQ0S,IACd,GAAIA,EAAMC,kBAAoB,EAAG,CAC/BY,GAAaX,UAAUF,EAAMne,QAC7B,MAAMif,EAAUd,EAAMne,OAAO0X,WAAU,GACvCuH,EAAQ5P,cAAc,iBAAiBpB,UAAYgR,EAAQ5P,cACzD,cACApB,UACFgR,EAAQ/T,QAAQ9E,UAAY,cAC5B+X,EAAMne,OAAO8K,cAAcM,aAAa6T,EAASd,EAAMne,YAbM,CACjEye,WAAY,aA6Bd,IAAII,GAZJ1Y,EAAe1E,OAAO,2BAA4B,CAChDa,KAAM,SAAUwB,GACdkb,GAAald,QAAQgC,EAAMyC,gBAE7B+E,YAAaxH,KAGbwH,eAAgBxH,OAoDlBqC,EAAe1E,OAAO,eAAgB,CACpCa,KAAM,SAAUwB,GACdka,GAAclc,QAAQgC,EAAMyC,eAC5BmY,GAAiB5c,QAAQgC,EAAMyC,gBAEjC+E,YAAaxH,KAGbwH,eAAgBxH,OC7FlBqC,EAAe1E,OAAO,iCAAkC,CACtD6J,KAAMxH,GACJjF,KAAK0M,QAAUzH,EAAMyC,cAAcwE,QAAQ,gBAC3CjH,EAAMyC,cAActE,iBAAiB,QAASpD,MAC9CiF,EAAMyC,cAAc2E,QAAQgU,QAAS,GAEvC5T,QAASxH,GACP,MAAMyH,QAAEA,GAAY1M,KACdsgB,EAAc7gB,SAAS8O,eA2FjC,SAAqB7B,GACnB,MAAO,cAAgBA,EAAQL,QAAQ+D,MA5FOmQ,CAAW7T,IACvD,GAAI4T,EACFA,EAAY9P,cAAc,cAAcgQ,YACnC,CACL,MAAMJ,EAgEZ,SAAe1T,GACb,MAAM0D,EAAQ1D,EAAQL,QAAQ+D,MACxBqQ,EAAOhhB,SAAS2M,cAAc,QACpCqU,EAAKpU,QAAQ9E,UAAY,cACzBkZ,EAAKpU,QAAQiS,IAAMlO,EACnBqQ,EAAKpU,QAAQgU,OAAS,OACtBI,EAAKnU,UAAUnM,IAAI,cACnBsgB,EAAKvO,GAAK,cAAgB9B,EAC1B,MAAMsQ,EAAa,mBAAqBtQ,EACxCqQ,EAAKpU,QAAQ+T,QAAU,OACvBK,EAAKrR,kDAAoDsR,yDACzD,MAAMpP,EAAS7R,SAAS2M,cAAc,UAStC,OARAkF,EAAO/F,YAAc,SACrB+F,EAAOhF,UAAUnM,IAAI,cACrBmR,EAAOhF,UAAUnM,IAAI,0BACrBmR,EAAOlO,iBAAiB,QAAS6B,IAC/Bwb,EAAKxU,cAAciD,YAAYuR,KAEjCnP,EAAOjF,QAAQsU,WAAa,OAC5BF,EAAKjU,YAAY8E,GACVmP,EApFa7Q,CAAKlD,GACrBA,EAAQT,cAAcgJ,aAAamL,EAAS1T,EAAQqJ,aACpDrK,OAAOgG,sBAAsB,WAC3B0O,EAAQ5P,cAAc,cAAcgQ,cAM5ClZ,EAAe1E,OAAO,iCAAkC,CACtD6J,KAAMxH,GACJ,MAAMyH,EAAW1M,KAAKyB,GAAKwD,EAAMyC,cAC3B6I,EAAYvQ,KAAKyB,GAAG+O,cAAc,wBACxCxQ,KAAKyQ,MAAQ,IAAI/E,OAAOgF,MAAMH,EAAW,CACvCI,QAAS,CACPC,QAAS,CACP,CAAC,OAAQ,SAAU,aACnB,CAAC,QAAS,cACV,CAAC,OAAQ,cACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,WAGLC,MAAO,SAET9Q,KAAK4Q,QAAU5Q,KAAKyB,GAAG+O,cAAc,eACrC,MAAMO,EAAU/Q,KAAKgR,QACfC,EAASjR,KAAKkR,OACpBlR,KAAKyB,GAAG6K,UAAUQ,OAAO,2BACzB9M,KAAKyQ,MAAMU,GAAG,mBAAoB,SAAUnE,EAAOoE,EAAUC,GACvDrE,EACF+D,EAAQrE,GAERuE,EAAOvE,KAGX1M,KAAKyQ,MAAMU,GAAG,cAAe,WAC3BzE,EAAQJ,UAAUnM,IAAI,0BACtBuM,EAAQL,QAAQuU,MAAQ,UAE1B,MAAMtP,EAAS7R,SAAS2M,cAAc,UACtCkF,EAAO/F,YAAc,SACrB+F,EAAOhF,UAAUnM,IAAI,cACrBmR,EAAOhF,UAAUnM,IAAI,0BACrBmR,EAAOlO,iBAAiB,QAAS6B,IAC/BjF,KAAKyB,GAAGwK,cAAciD,YAAYlP,KAAKyB,MAEzC6P,EAAOjF,QAAQkF,WAAa,OAC5BvR,KAAKyB,GAAG+K,YAAY8E,IAEtB7E,QAASC,GACPA,EAAQJ,UAAUnM,IAAI,yBAExBsM,OAAQC,GACNA,EAAQJ,UAAUQ,OAAO,wBACrBJ,EAAQL,QAAQwU,MvBnDxB,SAAiCjR,EAAMQ,EAAOyQ,GAC5C,MAAM9Q,EAAU,CACdxQ,KAAM,OACN2S,GAAI2O,EACJ7Q,iBAAkB,CAChBzQ,KAAM,gBACNuB,MAAOsP,GAETH,QAASL,GAEXnC,QAAQC,IAAI,aAAcqC,GAC1BtQ,SAAS6L,KAAK9F,cACZ,IAAIkG,OAAOpM,YAAY,qBAAsB,CAC3CuN,OAAQ,CAAEtN,KAAM,SAAU2Q,OAAQH,MuBuClC+Q,CAAgBpU,EAAQ8D,cAAc,cAAcpB,UAAW1C,EAAQL,QAAQiS,IAAK5R,EAAQL,QAAQwU,OvBvEnG,SAAwBjR,EAAMQ,GAEnC,MAAML,EAAU,CACdxQ,KAAM,OACNyQ,iBAAkB,CAChBzQ,KAAM,gBACNuB,MAAOsP,GAETH,QAASL,GAEXnC,QAAQC,IAAI,WAAYqC,GAExBtQ,SAAS6L,KAAK9F,cACZ,IAAIkG,OAAOpM,YAAY,mBAAoB,CACzCuN,OAAQ,CAAEtN,KAAM,SAAU2Q,OAAQH,MuB2DlCgR,CAAcrU,EAAQ8D,cAAc,cAAcpB,UAAW1C,EAAQL,QAAQiS,KAE/E5R,EAAQL,QAAQuU,MAAQ"}